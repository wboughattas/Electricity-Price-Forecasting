{"ast":null,"code":"import * as tslib_1 from \"tslib\"; //\n// Original version: https://github.com/mosa/Mono-Class-Libraries/blob/master/mcs/class/System.XML/System.Xml/XmlTextReader.cs\n//\n// System.Xml.XmlInputStream \n//\tencoding-specification-wise XML input stream and reader\n//\n// Author:\n//\tAtsushi Enomoto (ginga@kit.hi-ho.ne.jp)\n//\n//\t(C)2003 Atsushi Enomoto\n//\n//\n// Permission is hereby granted, free of charge, to any person obtaining\n// a copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to\n// permit persons to whom the Software is furnished to do so, subject to\n// the following conditions:\n// \n// The above copyright notice and this permission notice shall be\n// included in all copies or substantial portions of the Software.\n// \n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\n// EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n// NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE\n// LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\n// OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION\n// WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n//\n\nimport { Stream, NotSupportedException, callStaticConstructors, markType } from \"./type\";\nimport { Encoding } from \"./Encoding\";\nimport { XmlException } from \"./XmlException\";\nimport { UTF8Encoding } from \"./UTF8Encoding\";\nimport { StringBuilder } from \"./StringBuilder\";\nimport { XmlChar } from \"./XmlChar\";\nimport { Buffer } from \"./Buffer\";\n/**\r\n * @hidden\r\n */\n\nvar XmlInputStream =\n/** @class */\n\n/*@__PURE__*/\nfunction (_super) {\n  tslib_1.__extends(XmlInputStream, _super);\n\n  function XmlInputStream(a) {\n    var _this = _super.call(this) || this;\n\n    _this.w = null;\n    _this.t = null;\n    _this.o = null;\n    _this.p = 0;\n    _this.q = 0;\n\n    _this.y(a);\n\n    return _this;\n  }\n\n  XmlInputStream.staticInit = function () {\n    XmlInputStream.strictUTF8 = new UTF8Encoding(0, false, true);\n  };\n\n  XmlInputStream.prototype.u = function (a, b) {\n    var c = this.q;\n\n    while (this.q < a + b) {\n      if (this.r() < 0) {\n        return null;\n      }\n    }\n\n    this.q = c;\n    return Encoding.aSCII.getString1(this.o, a, b);\n  };\n\n  XmlInputStream.prototype.y = function (a) {\n    this.o = new Array(6);\n    this.t = a;\n    this.w = XmlInputStream.strictUTF8;\n    this.p = a.read(this.o, 0, this.o.length);\n\n    if (this.p == -1 || this.p == 0) {\n      return;\n    }\n\n    var b = this.r();\n\n    switch (b) {\n      case 255:\n        b = this.r();\n\n        if (b == 254) {\n          this.w = Encoding.unicode;\n        } else {\n          this.q = 0;\n        }\n\n        break;\n\n      case 254:\n        b = this.r();\n\n        if (b == 255) {\n          this.w = Encoding.bigEndianUnicode;\n          return;\n        } else {\n          this.q = 0;\n        }\n\n        break;\n\n      case 239:\n        b = this.r();\n\n        if (b == 187) {\n          b = this.r();\n\n          if (b != 191) {\n            this.q = 0;\n          }\n        } else {\n          this.o[--this.q] = 239;\n        }\n\n        break;\n\n      case '<'.charCodeAt(0):\n        if (this.p >= 5 && this.u(1, 4) == \"?xml\") {\n          this.q += 4;\n          b = this.s();\n\n          if (b == 'v'.charCodeAt(0)) {\n            while (b >= 0) {\n              b = this.r();\n\n              if (b == '0'.charCodeAt(0)) {\n                this.r();\n                break;\n              }\n            }\n\n            b = this.s();\n          }\n\n          if (b == 'e'.charCodeAt(0)) {\n            if (this.u(this.q, 7) == \"ncoding\") {\n              this.q += 7;\n              b = this.s();\n\n              if (b != '='.charCodeAt(0)) {\n                throw XmlInputStream.z;\n              }\n\n              b = this.s();\n              var c = b;\n              var d = new StringBuilder(0);\n\n              while (true) {\n                b = this.r();\n\n                if (b == c) {\n                  break;\n                } else if (b < 0) {\n                  throw XmlInputStream.z;\n                }\n\n                d.h(String.fromCharCode(b));\n              }\n\n              var e = d.toString();\n\n              if (!XmlChar.o(e)) {\n                throw XmlInputStream.z;\n              }\n\n              this.w = Encoding.getEncoding(e);\n            }\n          }\n        }\n\n        this.q = 0;\n        break;\n\n      default:\n        this.q = 0;\n        break;\n    }\n  };\n\n  XmlInputStream.prototype.r = function () {\n    if (this.p > this.q) {\n      return this.o[this.q++];\n    }\n\n    var a = new Array(this.o.length * 2);\n    Buffer.c(this.o, 0, a, 0, this.p);\n    var b = this.t.read(a, this.p, this.o.length);\n\n    if (b == -1 || b == 0) {\n      return -1;\n    }\n\n    this.p += b;\n    this.o = a;\n    return this.o[this.q++];\n  };\n\n  XmlInputStream.prototype.s = function () {\n    var a;\n\n    L0: while (true) {\n      a = this.r();\n      var t1 = String.fromCharCode(a);\n\n      L1: while (true) {\n        switch (t1) {\n          case '\\r':\n            t1 = ' ';\n            continue L1;\n\n          case '\\n':\n            t1 = ' ';\n            continue L1;\n\n          case '\\t':\n            t1 = ' ';\n            continue L1;\n\n          case ' ':\n            continue L0;\n\n          default:\n            return a;\n        }\n\n        break;\n      }\n    }\n  };\n\n  Object.defineProperty(XmlInputStream.prototype, \"actualEncoding\", {\n    get: function () {\n      return this.w;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  XmlInputStream.prototype.get_canRead = function () {\n    if (this.p > this.q) {\n      return true;\n    } else {\n      return this.t.canRead;\n    }\n  };\n\n  Object.defineProperty(XmlInputStream.prototype, \"canRead\", {\n    get: function () {\n      return this.get_canRead();\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  XmlInputStream.prototype.get_canSeek = function () {\n    return false;\n  };\n\n  Object.defineProperty(XmlInputStream.prototype, \"canSeek\", {\n    get: function () {\n      return this.get_canSeek();\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  XmlInputStream.prototype.get_canWrite = function () {\n    return false;\n  };\n\n  Object.defineProperty(XmlInputStream.prototype, \"canWrite\", {\n    get: function () {\n      return this.get_canWrite();\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  XmlInputStream.prototype.get_length = function () {\n    return this.t.length;\n  };\n\n  Object.defineProperty(XmlInputStream.prototype, \"length\", {\n    get: function () {\n      return this.get_length();\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  XmlInputStream.prototype.get_position = function () {\n    return this.t.position - this.p + this.q;\n  };\n\n  XmlInputStream.prototype.set_position = function (a) {\n    if (a < this.p) {\n      this.q = a;\n    } else {\n      this.t.position = a - this.p;\n    }\n  };\n\n  Object.defineProperty(XmlInputStream.prototype, \"position\", {\n    get: function () {\n      return this.get_position();\n    },\n    set: function (a) {\n      this.set_position(a);\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  XmlInputStream.prototype.close = function () {\n    this.t.close();\n  };\n\n  XmlInputStream.prototype.flush = function () {\n    this.t.flush();\n  };\n\n  XmlInputStream.prototype.read = function (a, b, c) {\n    var d;\n\n    if (c <= this.p - this.q) {\n      Buffer.c(this.o, this.q, a, b, c);\n      this.q += c;\n      d = c;\n    } else {\n      var e = this.p - this.q;\n\n      if (this.p > this.q) {\n        Buffer.c(this.o, this.q, a, b, e);\n        this.q += e;\n      }\n\n      d = e + this.t.read(a, b + e, c - e);\n    }\n\n    return d;\n  };\n\n  XmlInputStream.prototype.readByte = function () {\n    if (this.p > this.q) {\n      return this.o[this.q++];\n    }\n\n    return this.t.readByte();\n  };\n\n  XmlInputStream.prototype.seek = function (a, b) {\n    var c = this.p - this.q;\n\n    if (b == 1) {\n      if (a < c) {\n        return this.o[this.q + a];\n      } else {\n        return this.t.seek(a - c, b);\n      }\n    } else {\n      return this.t.seek(a, b);\n    }\n  };\n\n  XmlInputStream.prototype.setLength = function (a) {\n    this.t.setLength(a);\n  };\n\n  XmlInputStream.prototype.write = function (a, b, c) {\n    throw new NotSupportedException(0);\n  };\n\n  XmlInputStream.$t = markType(XmlInputStream, 'XmlInputStream', Stream.$);\n  XmlInputStream.strictUTF8 = null;\n  XmlInputStream.z = new XmlException(3, \"invalid encoding specification.\");\n  return XmlInputStream;\n}(Stream);\n\nexport { XmlInputStream };\n\n(function (v) {\n  callStaticConstructors();\n})(true);","map":{"version":3,"sources":["../../../../src/igniteui-core/lib/XmlInputStream.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import * as tslib_1 from \"tslib\";\r\n//\r\n// Original version: https://github.com/mosa/Mono-Class-Libraries/blob/master/mcs/class/System.XML/System.Xml/XmlTextReader.cs\r\n//\r\n// System.Xml.XmlInputStream \r\n//\tencoding-specification-wise XML input stream and reader\r\n//\r\n// Author:\r\n//\tAtsushi Enomoto (ginga@kit.hi-ho.ne.jp)\r\n//\r\n//\t(C)2003 Atsushi Enomoto\r\n//\r\n//\r\n// Permission is hereby granted, free of charge, to any person obtaining\r\n// a copy of this software and associated documentation files (the\r\n// \"Software\"), to deal in the Software without restriction, including\r\n// without limitation the rights to use, copy, modify, merge, publish,\r\n// distribute, sublicense, and/or sell copies of the Software, and to\r\n// permit persons to whom the Software is furnished to do so, subject to\r\n// the following conditions:\r\n// \r\n// The above copyright notice and this permission notice shall be\r\n// included in all copies or substantial portions of the Software.\r\n// \r\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\r\n// EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\r\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\r\n// NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE\r\n// LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\r\n// OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION\r\n// WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n//\r\nimport { Stream, NotSupportedException, callStaticConstructors, markType } from \"./type\";\r\nimport { Encoding } from \"./Encoding\";\r\nimport { XmlException } from \"./XmlException\";\r\nimport { UTF8Encoding } from \"./UTF8Encoding\";\r\nimport { StringBuilder } from \"./StringBuilder\";\r\nimport { XmlChar } from \"./XmlChar\";\r\nimport { Buffer } from \"./Buffer\";\r\n/**\r\n * @hidden\r\n */\r\nvar XmlInputStream = /** @class */ /*@__PURE__*/ (function (_super) {\r\n    tslib_1.__extends(XmlInputStream, _super);\r\n    function XmlInputStream(a) {\r\n        var _this = _super.call(this) || this;\r\n        _this.w = null;\r\n        _this.t = null;\r\n        _this.o = null;\r\n        _this.p = 0;\r\n        _this.q = 0;\r\n        _this.y(a);\r\n        return _this;\r\n    }\r\n    XmlInputStream.staticInit = function () {\r\n        XmlInputStream.strictUTF8 = new UTF8Encoding(0, false, true);\r\n    };\r\n    XmlInputStream.prototype.u = function (a, b) {\r\n        var c = this.q;\r\n        while (this.q < a + b) {\r\n            if (this.r() < 0) {\r\n                return null;\r\n            }\r\n        }\r\n        this.q = c;\r\n        return Encoding.aSCII.getString1(this.o, a, b);\r\n    };\r\n    XmlInputStream.prototype.y = function (a) {\r\n        this.o = new Array(6);\r\n        this.t = a;\r\n        this.w = XmlInputStream.strictUTF8;\r\n        this.p = a.read(this.o, 0, this.o.length);\r\n        if (this.p == -1 || this.p == 0) {\r\n            return;\r\n        }\r\n        var b = this.r();\r\n        switch (b) {\r\n            case 255:\r\n                b = this.r();\r\n                if (b == 254) {\r\n                    this.w = Encoding.unicode;\r\n                }\r\n                else {\r\n                    this.q = 0;\r\n                }\r\n                break;\r\n            case 254:\r\n                b = this.r();\r\n                if (b == 255) {\r\n                    this.w = Encoding.bigEndianUnicode;\r\n                    return;\r\n                }\r\n                else {\r\n                    this.q = 0;\r\n                }\r\n                break;\r\n            case 239:\r\n                b = this.r();\r\n                if (b == 187) {\r\n                    b = this.r();\r\n                    if (b != 191) {\r\n                        this.q = 0;\r\n                    }\r\n                }\r\n                else {\r\n                    this.o[--this.q] = 239;\r\n                }\r\n                break;\r\n            case '<'.charCodeAt(0):\r\n                if (this.p >= 5 && this.u(1, 4) == \"?xml\") {\r\n                    this.q += 4;\r\n                    b = this.s();\r\n                    if (b == 'v'.charCodeAt(0)) {\r\n                        while (b >= 0) {\r\n                            b = this.r();\r\n                            if (b == '0'.charCodeAt(0)) {\r\n                                this.r();\r\n                                break;\r\n                            }\r\n                        }\r\n                        b = this.s();\r\n                    }\r\n                    if (b == 'e'.charCodeAt(0)) {\r\n                        if (this.u(this.q, 7) == \"ncoding\") {\r\n                            this.q += 7;\r\n                            b = this.s();\r\n                            if (b != '='.charCodeAt(0)) {\r\n                                throw XmlInputStream.z;\r\n                            }\r\n                            b = this.s();\r\n                            var c = b;\r\n                            var d = new StringBuilder(0);\r\n                            while (true) {\r\n                                b = this.r();\r\n                                if (b == c) {\r\n                                    break;\r\n                                }\r\n                                else if (b < 0) {\r\n                                    throw XmlInputStream.z;\r\n                                }\r\n                                d.h(String.fromCharCode(b));\r\n                            }\r\n                            var e = d.toString();\r\n                            if (!XmlChar.o(e)) {\r\n                                throw XmlInputStream.z;\r\n                            }\r\n                            this.w = Encoding.getEncoding(e);\r\n                        }\r\n                    }\r\n                }\r\n                this.q = 0;\r\n                break;\r\n            default:\r\n                this.q = 0;\r\n                break;\r\n        }\r\n    };\r\n    XmlInputStream.prototype.r = function () {\r\n        if (this.p > this.q) {\r\n            return this.o[this.q++];\r\n        }\r\n        var a = new Array(this.o.length * 2);\r\n        Buffer.c(this.o, 0, a, 0, this.p);\r\n        var b = this.t.read(a, this.p, this.o.length);\r\n        if (b == -1 || b == 0) {\r\n            return -1;\r\n        }\r\n        this.p += b;\r\n        this.o = a;\r\n        return this.o[this.q++];\r\n    };\r\n    XmlInputStream.prototype.s = function () {\r\n        var a;\r\n        L0: while (true) {\r\n            a = this.r();\r\n            var t1 = String.fromCharCode(a);\r\n            L1: while (true) {\r\n                switch (t1) {\r\n                    case '\\r':\r\n                        t1 = ' ';\r\n                        continue L1;\r\n                    case '\\n':\r\n                        t1 = ' ';\r\n                        continue L1;\r\n                    case '\\t':\r\n                        t1 = ' ';\r\n                        continue L1;\r\n                    case ' ': continue L0;\r\n                    default: return a;\r\n                }\r\n                break;\r\n            }\r\n        }\r\n    };\r\n    Object.defineProperty(XmlInputStream.prototype, \"actualEncoding\", {\r\n        get: function () {\r\n            return this.w;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    XmlInputStream.prototype.get_canRead = function () {\r\n        if (this.p > this.q) {\r\n            return true;\r\n        }\r\n        else {\r\n            return this.t.canRead;\r\n        }\r\n    };\r\n    Object.defineProperty(XmlInputStream.prototype, \"canRead\", {\r\n        get: function () {\r\n            return this.get_canRead();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    XmlInputStream.prototype.get_canSeek = function () {\r\n        return false;\r\n    };\r\n    Object.defineProperty(XmlInputStream.prototype, \"canSeek\", {\r\n        get: function () {\r\n            return this.get_canSeek();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    XmlInputStream.prototype.get_canWrite = function () {\r\n        return false;\r\n    };\r\n    Object.defineProperty(XmlInputStream.prototype, \"canWrite\", {\r\n        get: function () {\r\n            return this.get_canWrite();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    XmlInputStream.prototype.get_length = function () {\r\n        return this.t.length;\r\n    };\r\n    Object.defineProperty(XmlInputStream.prototype, \"length\", {\r\n        get: function () {\r\n            return this.get_length();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    XmlInputStream.prototype.get_position = function () {\r\n        return this.t.position - this.p + this.q;\r\n    };\r\n    XmlInputStream.prototype.set_position = function (a) {\r\n        if (a < this.p) {\r\n            this.q = a;\r\n        }\r\n        else {\r\n            this.t.position = a - this.p;\r\n        }\r\n    };\r\n    Object.defineProperty(XmlInputStream.prototype, \"position\", {\r\n        get: function () {\r\n            return this.get_position();\r\n        },\r\n        set: function (a) {\r\n            this.set_position(a);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    XmlInputStream.prototype.close = function () {\r\n        this.t.close();\r\n    };\r\n    XmlInputStream.prototype.flush = function () {\r\n        this.t.flush();\r\n    };\r\n    XmlInputStream.prototype.read = function (a, b, c) {\r\n        var d;\r\n        if (c <= this.p - this.q) {\r\n            Buffer.c(this.o, this.q, a, b, c);\r\n            this.q += c;\r\n            d = c;\r\n        }\r\n        else {\r\n            var e = this.p - this.q;\r\n            if (this.p > this.q) {\r\n                Buffer.c(this.o, this.q, a, b, e);\r\n                this.q += e;\r\n            }\r\n            d = e + this.t.read(a, b + e, c - e);\r\n        }\r\n        return d;\r\n    };\r\n    XmlInputStream.prototype.readByte = function () {\r\n        if (this.p > this.q) {\r\n            return this.o[this.q++];\r\n        }\r\n        return this.t.readByte();\r\n    };\r\n    XmlInputStream.prototype.seek = function (a, b) {\r\n        var c = this.p - this.q;\r\n        if (b == 1) {\r\n            if (a < c) {\r\n                return this.o[this.q + a];\r\n            }\r\n            else {\r\n                return this.t.seek(a - c, b);\r\n            }\r\n        }\r\n        else {\r\n            return this.t.seek(a, b);\r\n        }\r\n    };\r\n    XmlInputStream.prototype.setLength = function (a) {\r\n        this.t.setLength(a);\r\n    };\r\n    XmlInputStream.prototype.write = function (a, b, c) {\r\n        throw new NotSupportedException(0);\r\n    };\r\n    XmlInputStream.$t = markType(XmlInputStream, 'XmlInputStream', Stream.$);\r\n    XmlInputStream.strictUTF8 = null;\r\n    XmlInputStream.z = new XmlException(3, \"invalid encoding specification.\");\r\n    return XmlInputStream;\r\n}(Stream));\r\nexport { XmlInputStream };\r\n(function (v) { callStaticConstructors(); })(true);\r\n//# sourceMappingURL=XmlInputStream.js.map\r\n"]},"metadata":{},"sourceType":"module"}