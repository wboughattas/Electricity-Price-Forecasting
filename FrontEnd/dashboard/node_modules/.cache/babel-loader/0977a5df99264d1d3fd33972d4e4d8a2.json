{"ast":null,"code":"/*\r\nTHIS INFRAGISTICS ULTIMATE SOFTWARE LICENSE  AGREEMENT (\"AGREEMENT\") LOCATED HERE:\r\nhttps://www.infragistics.com/legal/license/igultimate-la\r\nhttps://www.infragistics.com/legal/license/igultimate-eula\r\nGOVERNS THE LICENSING, INSTALLATION AND USE OF INFRAGISTICS SOFTWARE. BY DOWNLOADING AND/OR INSTALLING AND USING INFRAGISTICS SOFTWARE:  you are indicating that you have read and understand this Agreement, and agree to be legally bound by it on behalf of the yourself and your company.\r\n*/\nimport * as tslib_1 from \"tslib\";\nimport { BaseDataSource } from \"./BaseDataSource\";\nimport { IPageCandidatesSink_$type } from \"./IPageCandidatesSink\";\nimport { PagePredictionEngine } from \"./PagePredictionEngine\";\nimport { LRUCache$2 } from \"./LRUCache$2\";\nimport { Base, runOn, Array_$type, Number_$type, typeCast, fromEnum, typeGetValue, String_$type, Boolean_$type, markType } from \"./type\";\nimport { IDataSourcePage_$type } from \"./IDataSourcePage\";\nimport { Dictionary$2 } from \"./Dictionary$2\";\nimport { SectionMap } from \"./SectionMap\";\nimport { DataSourceExecutionContext } from \"./DataSourceExecutionContext\";\nimport { SectionData } from \"./SectionData\";\nimport { List$1 } from \"./List$1\";\nimport { DataSourceSpecialRow } from \"./DataSourceSpecialRow\";\nimport { DataSourcePropertiesComparer } from \"./DataSourcePropertiesComparer\";\nimport { TransactionState } from \"./TransactionState\";\nimport { TransactionType } from \"./TransactionType\";\nimport { DataSourceBatchStartedEventArgs } from \"./DataSourceBatchStartedEventArgs\";\nimport { DataSourceBatchCompletedEventArgs } from \"./DataSourceBatchCompletedEventArgs\";\nimport { truncate, intDivide } from \"./number\";\n/**\r\n * @hidden\r\n */\n\nvar VirtualDataSource =\n/** @class */\n\n/*@__PURE__*/\nfunction (_super) {\n  tslib_1.__extends(VirtualDataSource, _super);\n\n  function VirtualDataSource() {\n    var _this = _super.call(this) || this;\n\n    _this.cu = null;\n    _this.dd = false;\n    _this.d0 = 0;\n    _this.c7 = null;\n    _this.cy = null;\n    _this.cx = null;\n    _this.dz = 50;\n    _this.dy = 200;\n    _this.actualPageSizePopulated = false;\n    _this.dj = 50;\n    _this.db = false;\n    _this.c2 = null;\n    _this.cs = null;\n    _this.ct = null;\n    _this.da = new LRUCache$2(Base.$, IDataSourcePage_$type, 0, 200);\n    _this.dh = new Dictionary$2(Base.$, Array_$type, 0);\n    _this.di = new Dictionary$2(Number_$type, Number_$type, 0);\n    _this.dc = false;\n    _this.cq = null;\n    _this.cv = null;\n    _this.c9 = new SectionMap();\n    _this.cr = null;\n    _this.ds = -1;\n    _this.dk = -1;\n    _this.du = -1;\n    _this.dm = -1;\n    _this.dv = -1;\n    _this.dn = -1;\n    _this.dt = -1;\n    _this.dl = -1;\n    _this.dx = -1;\n    _this.dw = -1;\n    _this.dq = -1;\n    _this.dp = -1;\n    _this.dr = -1;\n    _this.dg = new Dictionary$2(String_$type, Boolean_$type, 0);\n    _this._concurrencyTag = null;\n    _this.batchStarted = null;\n    _this.batchCompleted = null;\n    _this.c7 = new PagePredictionEngine();\n    _this.c7.e = _this;\n    _this.c7.ag = _this.actualPageSize;\n    _this.c7.f = _this.c9;\n    _this.executionContext = new DataSourceExecutionContext();\n    _this.c7.b = _this.executionContext;\n    _this.isReadOnly = true;\n    return _this;\n  }\n\n  VirtualDataSource.prototype.get_isSectionCollapsable = function () {\n    if (!this.isSectionContentVisible) {\n      return true;\n    }\n\n    return _super.prototype.get_isSectionCollapsable.call(this);\n  };\n\n  VirtualDataSource.prototype.set_isSectionCollapsable = function (a) {\n    _super.prototype.set_isSectionCollapsable.call(this, a);\n  };\n\n  VirtualDataSource.prototype.get_isSectionExpandedDefault = function () {\n    if (!this.isSectionContentVisible) {\n      return false;\n    }\n\n    if (this.isSectionCollapsable) {\n      return _super.prototype.get_isSectionExpandedDefault.call(this);\n    }\n\n    return true;\n  };\n\n  VirtualDataSource.prototype.set_isSectionExpandedDefault = function (a) {\n    _super.prototype.set_isSectionExpandedDefault.call(this, a);\n  };\n\n  VirtualDataSource.prototype.get_actualBaseDataProvider = function () {\n    return this.actualDataProvider;\n  };\n\n  Object.defineProperty(VirtualDataSource.prototype, \"actualBaseDataProvider\", {\n    get: function () {\n      return this.get_actualBaseDataProvider();\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(VirtualDataSource.prototype, \"dataProvider\", {\n    get: function () {\n      return this.cy;\n    },\n    set: function (a) {\n      var b = this.cy;\n      this.cy = a;\n\n      if (b != this.cy) {\n        this.onPropertyUpdated(\"DataProvider\", b, this.cy);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(VirtualDataSource.prototype, \"actualDataProvider\", {\n    get: function () {\n      if (this.cx == null) {\n        this.actualDataProvider = this.resolveDataProvider();\n      }\n\n      return this.cx;\n    },\n    set: function (a) {\n      var b = this.cx;\n      this.cx = a;\n\n      if (b != this.cx) {\n        this.onPropertyUpdated(\"ActualDataProvider\", b, this.cx);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(VirtualDataSource.prototype, \"pageSizeRequested\", {\n    get: function () {\n      return this.dz;\n    },\n    set: function (a) {\n      var b = this.dz;\n      this.dz = a;\n\n      if (b != this.dz) {\n        this.onPropertyUpdated(\"PageSizeRequested\", b, this.dz);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  VirtualDataSource.prototype.resetCache = function () {\n    if (this.c3 != null) {\n      this.c3.resetCache();\n    }\n\n    this.resetCacheOverride();\n  };\n\n  VirtualDataSource.prototype.resetCacheOverride = function () {\n    this.da.i();\n  };\n\n  Object.defineProperty(VirtualDataSource.prototype, \"maxCachedPages\", {\n    get: function () {\n      return this.dy;\n    },\n    set: function (a) {\n      var b = this.dy;\n      this.dy = a;\n\n      if (b != this.dy) {\n        this.onPropertyUpdated(\"MaxCachedPages\", b, this.dy);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(VirtualDataSource.prototype, \"actualPageSize\", {\n    get: function () {\n      return this.dj;\n    },\n    set: function (a) {\n      var b = this.dj;\n      this.dj = a;\n\n      if (b != this.dj) {\n        this.onPropertyUpdated(\"ActualPageSize\", b, this.dj);\n      }\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  VirtualDataSource.prototype.get_isSortingSupported = function () {\n    if (this.externalDataSource != null && !this.db) {\n      this.db = true;\n      var a = this.externalDataSource.isSortingSupportedOverride;\n      this.db = false;\n      return a;\n    }\n\n    return false;\n  };\n\n  VirtualDataSource.prototype.get_isFilteringSupported = function () {\n    if (this.externalDataSource != null && !this.db) {\n      this.db = true;\n      var a = this.externalDataSource.isFilteringSupportedOverride;\n      this.db = false;\n      return a;\n    }\n\n    return false;\n  };\n\n  VirtualDataSource.prototype.get_isGroupingSupported = function () {\n    if (this.externalDataSource != null && !this.db) {\n      this.db = true;\n      var a = this.externalDataSource.isGroupingSupportedOverride;\n      this.db = false;\n      return a;\n    }\n\n    return false;\n  };\n\n  Object.defineProperty(VirtualDataSource.prototype, \"c3\", {\n    get: function () {\n      return this.c2;\n    },\n    set: function (a) {\n      this.c2 = a;\n      this.actualDataProvider = this.resolveDataProvider();\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  VirtualDataSource.prototype.resolveDataProvider = function () {\n    if (this.c3 == null) {\n      return null;\n    }\n\n    return this.c3.resolveDataProvider();\n  };\n\n  VirtualDataSource.prototype.propertyUpdatedOverride = function (a, b, c) {\n    _super.prototype.propertyUpdatedOverride.call(this, a, b, c);\n\n    switch (a) {\n      case \"DataProvider\":\n        this.actualDataProvider = this.dataProvider;\n        this.queueAutoRefresh();\n        break;\n\n      case \"ExecutionContext\":\n        this.c7.b = this.executionContext;\n        break;\n\n      case \"ActualDataProvider\":\n        this.actualDataProvider.pageSizeRequested = this.pageSizeRequested;\n        this.actualDataProvider.pageLoaded = runOn(this, this.ek);\n        this.actualDataProvider.batchCompleted = runOn(this, this.ej);\n        this.queueAutoRefresh();\n        break;\n\n      case \"PageSizeRequested\":\n        this.actualPageSize = this.pageSizeRequested;\n\n        if (this.actualDataProvider != null) {\n          this.actualDataProvider.pageSizeRequested = this.pageSizeRequested;\n        }\n\n        this.queueAutoRefresh();\n        break;\n\n      case \"ActualPageSize\":\n        this.c7.ag = this.actualPageSize;\n        this.queueAutoRefresh();\n        break;\n\n      case \"FirstVisibleIndexRequested\":\n        this.c7.aa = this.firstVisibleIndexRequested;\n        break;\n\n      case \"LastVisibleIndexRequested\":\n        this.c7.ae = this.lastVisibleIndexRequested;\n        break;\n\n      case \"ActualCount\":\n        if (this.actualDataProvider != null && !this.c9.q) {\n          this.c7.ab = this.actualDataProvider.actualCount;\n        } else {\n          this.c7.ab = this.actualCount;\n        }\n\n        this.queueAutoRefresh();\n        break;\n\n      case \"MaxCachedPages\":\n        this.da.h = this.maxCachedPages;\n        break;\n    }\n  };\n\n  VirtualDataSource.prototype.d3 = function (a) {\n    if (this.an && this.c9.q) {\n      var b = this.c8(a);\n\n      if (b == null) {\n        b = this.c9.d();\n      }\n\n      return a - b.t;\n    }\n\n    return a;\n  };\n\n  VirtualDataSource.prototype.ek = function (a, b, c) {\n    var _this = this;\n\n    var d = this.executionContext;\n\n    if (d != null) {\n      d.execute(function () {\n        return _this.eq(a, b, c);\n      });\n    } else {\n      this.eq(a, b, c);\n    }\n  };\n\n  VirtualDataSource.prototype.eq = function (a, b, c) {\n    if (a == null) {\n      b = this.resolveFullCount(b);\n\n      if (this.actualCount != b) {\n        this.actualCount = b;\n      }\n\n      return;\n    }\n\n    if (c != this.actualPageSize && !this.actualPageSizePopulated) {\n      this.actualPageSize = c;\n    }\n\n    this.actualPageSizePopulated = true;\n    var d = a.pageIndex();\n    this.el(d);\n    this.da.item(d, a);\n    var e = a.schema();\n\n    if (e != null) {\n      this.actualSchema = e;\n    }\n\n    var f = a.getSummaryInformation();\n\n    if (this.summaryDescriptions.k.count > 0 && this.cv == null && f != null) {\n      this.cv = f;\n\n      for (var g = 0; g < this.summaryDescriptions.k.count; g++) {\n        this.cv[g].summaryIndex = g;\n      }\n\n      var h = SectionData.r(this.cv);\n      this.d0 = h.count;\n    }\n\n    var i = a.getGroupInformation();\n\n    if (this.groupDescriptions.k.count > 0 && this.cq == null && i != null) {\n      this.cq = i;\n      this.ep();\n      this.dd = false;\n    }\n\n    b = this.resolveFullCount(b);\n\n    if (this.actualCount != b) {\n      this.actualCount = b;\n    }\n\n    this.eo(a);\n  };\n\n  VirtualDataSource.prototype.resolveFullCount = function (a) {\n    if (this.cq != null) {\n      return this.c9.u + this.d0;\n    }\n\n    return a + this.d0;\n  };\n\n  VirtualDataSource.prototype.ep = function () {\n    var a = 0;\n    var b = 0;\n    var c = this.shouldEmitSectionHeaders;\n    var d = this.shouldEmitSectionFooters;\n\n    for (var e = 0; e < this.cq.length; e++) {\n      var f = new SectionData();\n      var g = b;\n      var h = this.cq[e].endIndex - this.cq[e].startIndex;\n      f.af = a;\n      f.ae = e;\n      f.d = new Array(this.groupDescriptions.k.count);\n\n      for (var i = 0; i < this.groupDescriptions.k.count; i++) {\n        f.d[i] = 0;\n      }\n\n      f.ad = a + h;\n      f.t = 0;\n      f.e = this.cq[e].groupKeyProperties;\n      f.f = this.cq[e].groupKeyValues;\n      f.h = new Array(0);\n      f.ai(this.sectionHeaderDisplayMode, this.isSectionExpandedDefault);\n      this.ei(f, e == 0);\n\n      if (d) {\n        f.u = f.c.length;\n      }\n\n      var j = 0;\n      f.i = new Array(this.groupDescriptions.k.count);\n\n      if (this.summaryScope == 0 || this.summaryScope == 2) {\n        if (this.cq[e].summaryResults != null) {\n          f.i[this.groupDescriptions.k.count - 1] = this.cq[e].summaryResults;\n\n          if (f.i != null) {\n            for (var k = 0; k < f.i[this.groupDescriptions.k.count - 1].length; k++) {\n              f.i[this.groupDescriptions.k.count - 1][k].summaryIndex = k;\n            }\n\n            j = SectionData.r(f.i[this.groupDescriptions.k.count - 1]).count;\n          }\n        }\n      }\n\n      if (this.includeSummaryRowsInSection) {\n        if (this.isSectionSummaryRowsAtBottom) {\n          f.ag = j;\n        } else {\n          f.ah = j;\n          g += j;\n        }\n\n        b += j;\n        f.ad += j;\n      }\n\n      if (d) {\n        b++;\n      }\n\n      var l = 0;\n      f.b = new Array(f.c.length);\n\n      if (f.z > -1) {\n        var m = this.c9.t._inner[f.z];\n\n        for (var n = 0; n < m.f.length; n++) {\n          l = n;\n\n          if (!Base.equalsStatic(m.f[n], f.f[n])) {\n            break;\n          }\n        }\n      }\n\n      for (var o = l; o < f.c.length; o++) {\n        b++;\n        g++;\n        f.ad++;\n        var p = this.ec(f, o);\n        f.a[o] = p;\n        f.b[o] = o - l;\n\n        if (this.dg.containsKey(p)) {\n          f.c[o] = this.dg.item(p);\n        } else {\n          f.c[o] = this.isSectionExpandedDefault;\n        }\n\n        if (!f.c[o]) {\n          var q = 0;\n          var r = f.c.length - 1 - o;\n          f.ad -= q;\n          b -= q;\n\n          if (d) {\n            b--;\n            f.u--;\n          }\n\n          o += r;\n        }\n      }\n\n      f.y = f.v();\n      f.t = g;\n      this.c9.z(f, h + 1);\n\n      if (!f.p) {\n        var s = f.w();\n        f.ad -= f.d[s] + j;\n        b -= f.d[s] + j;\n      }\n\n      a = f.ad + 1;\n      this.c9.t.add(f);\n      f.q = this.c9.r(f);\n    }\n\n    var t = 0;\n\n    for (var u = 0; u < this.c9.t.count; u++) {\n      var v = this.c9.t._inner[u];\n\n      if (this.shouldEmitSectionHeaders) {\n        if (!v.q) {\n          var w = v.ad - v.af + 1;\n          this.c9.ae(v.ae);\n          this.c9.ab(v, -w, -w);\n          u--;\n          t++;\n          continue;\n        }\n      }\n\n      if (v.z > -1) {\n        v.z -= t;\n      }\n    }\n  };\n\n  VirtualDataSource.prototype.ei = function (a, b) {\n    if (b) {\n      this.cs = new Array(this.groupDescriptions.k.count);\n\n      for (var c = 0; c < this.cs.length; c++) {\n        this.cs[c] = a;\n      }\n    }\n\n    if (this.sectionHeaderDisplayMode == 1) {\n      var d = false;\n      var e = a.e.length;\n\n      for (var f = 0; f < e; f++) {\n        if (d) {\n          this.cs[f] = a;\n          continue;\n        }\n\n        var g = false;\n\n        if (this.cs[f].f[f] == null) {\n          g = a.f[f] != null;\n        } else {\n          g = !Base.equalsStatic(this.cs[f].f[f], a.f[f]);\n        }\n\n        if (g) {\n          this.cs[f] = a;\n\n          if (f - 1 > -1) {\n            var h = f - 1;\n\n            while (h >= 0 && this.cs[h].o) {\n              h = h - 1;\n            }\n\n            a.z = this.cs[h].ae;\n          }\n\n          d = true;\n        }\n      }\n    } else {\n      var i = false;\n\n      for (var j = 0; j < a.e.length; j++) {\n        if (this.cs[0].f[j] == null) {\n          if (this.cs[0].f[j] != a.f[j]) {\n            i = true;\n            break;\n          }\n\n          continue;\n        }\n\n        if (!Base.equalsStatic(this.cs[0].f[j], a.f[j])) {\n          i = true;\n          break;\n        }\n      }\n\n      if (i) {\n        this.cs[0] = a;\n      }\n    }\n  };\n\n  VirtualDataSource.prototype.eh = function (a) {};\n\n  VirtualDataSource.prototype.eo = function (a) {\n    if (this.updateNotifier != null) {\n      var b = a.pageIndex() * this.actualPageSize;\n\n      if (this.actualDataProvider != null) {\n        if (b > this.actualDataProvider.actualCount) {\n          return;\n        }\n      }\n\n      var c = this.d2(b);\n      var d = this.d2(b + a.count() - 1);\n\n      if (c > 0 && this.getRowType(c - 1) == 1) {\n        c--;\n      }\n\n      if (this.actualCount == 0 && a.count() == 0) {\n        this.onClearItems();\n      } else {\n        this.updateNotifier.rangeActualized(c, d);\n      }\n    }\n  };\n\n  VirtualDataSource.prototype.d2 = function (a) {\n    if (this.an && this.c9.q) {\n      var b = this.c9.g(a);\n\n      if (b == null) {\n        b = this.c9.d();\n      }\n\n      if (!b.p) {\n        return b.af;\n      }\n\n      return a + b.t;\n    }\n\n    return a;\n  };\n\n  VirtualDataSource.prototype.em = function (a) {\n    a();\n  };\n\n  VirtualDataSource.prototype.get_isVirtual = function () {\n    return true;\n  };\n\n  VirtualDataSource.prototype.isPlaceholderItem = function (a) {\n    var b = this.cw(a);\n    var c = b[0];\n\n    if (!this.da.d(c)) {\n      if (b[1] == -1) {\n        return false;\n      }\n\n      return true;\n    }\n\n    return false;\n  };\n\n  VirtualDataSource.prototype.getItemAtIndex = function (a) {\n    if (a >= this.actualCount - this.d0) {\n      return this.d7(a);\n    }\n\n    var b = this.cw(a);\n    var c = b[0];\n\n    if (!this.da.d(c)) {\n      if (b[1] == -1) {\n        return this.d7(a);\n      }\n\n      return null;\n    }\n\n    var d = this.da.item(c);\n    var e = b[1];\n\n    if (e == -1) {\n      return this.d7(a);\n    }\n\n    return d.getItemAtIndex(e);\n  };\n\n  VirtualDataSource.prototype.d7 = function (a) {\n    if (a >= this.actualCount - this.d0) {\n      var b = new DataSourceSpecialRow();\n      b.rowType = 4;\n      b.level = 0;\n      var c = a - (this.actualCount - this.d0);\n      var d = SectionData.r(this.cv);\n      var e = new Array(d._inner[c].count);\n\n      d._inner[c].values.copyTo(e, 0);\n\n      b.summaryResults = e;\n      return b;\n    }\n\n    var f = this.c8(a);\n\n    if (f != null) {\n      var g = f.j(a);\n\n      if (g == 1 || g == 2) {\n        var h = new DataSourceSpecialRow();\n        h.rowType = g;\n        h.summaryResults = f.i[f.i.length - 1];\n        h.level = g == 1 ? f.w() + (a - f.af) : f.u - 1 - (f.w() + (a - (f.ad - f.u + 1)));\n\n        if (this.sectionHeaderDisplayMode == 0) {\n          for (var i = 0; i < this.groupDescriptions.k.count; i++) {\n            h.setSectionValue(this.groupDescriptions.k.item(i).propertyName, f.f[i]);\n            h.setValue(this.groupDescriptions.k.item(i).propertyName, f.f[i]);\n          }\n        } else {\n          if (h.level >= 0 && h.level < this.groupDescriptions.k.count) {\n            h.setSectionValue(this.groupDescriptions.k.item(h.level).propertyName, f.f[h.level]);\n            h.setValue(this.groupDescriptions.k.item(h.level).propertyName, f.f[h.level]);\n          }\n        }\n\n        return h;\n      } else if (g == 5) {\n        var j = new DataSourceSpecialRow();\n        j.rowType = 5;\n        j.level = f.c.length;\n        var k = f.x(a);\n        var l = SectionData.r(f.i[f.i.length - 1]);\n        var m = new Array(l._inner[k].count);\n\n        l._inner[k].values.copyTo(m, 0);\n\n        j.summaryResults = m;\n        return j;\n      }\n    }\n\n    return null;\n  };\n\n  VirtualDataSource.prototype.cw = function (a) {\n    if (this.an && this.c9.q) {\n      var b = false;\n      var c = this.c8(a);\n\n      if (c == null) {\n        c = this.c9.d();\n\n        if (this.cv.length > 0 && a > c.ad) {\n          b = true;\n        }\n      }\n\n      var d = c.af;\n\n      if (this.shouldEmitSectionHeaders && a >= d && a < d + c.v()) {\n        b = true;\n      }\n\n      if (a - (d + c.v() - 1) <= c.aa + c.ah) {\n        b = true;\n      }\n\n      if (this.shouldEmitSectionFooters) {\n        if (a <= c.ad && a >= c.ad - c.c.length - c.ag) {\n          b = true;\n        }\n      } else if (c.ag > 0) {\n        if (a > c.ad - c.ag && a <= c.ad) {\n          b = true;\n        }\n      }\n\n      var e = a - c.t;\n      var f = truncate(Math.floor(e / this.actualPageSize));\n      var g = e % this.actualPageSize;\n\n      if (b) {\n        g = -1;\n      }\n\n      var h = new Array(2);\n      h[0] = f;\n      h[1] = g;\n      return h;\n    } else {\n      var i = truncate(Math.floor(a / this.actualPageSize));\n      var j = a % this.actualPageSize;\n      var k = new Array(2);\n      k[0] = i;\n      k[1] = j;\n      return k;\n    }\n  };\n\n  VirtualDataSource.prototype.c8 = function (a) {\n    return this.c9.e(a);\n  };\n\n  VirtualDataSource.prototype.getItemPropertyAtIndex = function (a, b) {\n    if (a > this.actualCount - 1 - this.d0) {\n      return this.d8(a, b);\n    }\n\n    var c = this.cw(a);\n    var d = c[0];\n\n    if (!this.da.d(d)) {\n      if (c[1] == -1) {\n        return this.d8(a, b);\n      }\n\n      return null;\n    }\n\n    var e = this.da.item(d);\n    var f = c[1];\n\n    if (f == -1) {\n      return this.d8(a, b);\n    }\n\n    if (this.ao()) {\n      var g = e.getItemAtIndex(f);\n      var h = this.al(g, b);\n\n      if (h) {\n        var i = this.ay(g, b);\n        return i;\n      }\n    }\n\n    return e.getItemValueAtIndex(f, b);\n  };\n\n  VirtualDataSource.prototype.d8 = function (a, b) {\n    var c = this.d7(a);\n\n    if (typeCast(DataSourceSpecialRow.$, c) !== null) {\n      return c.getValue(b);\n    }\n\n    return null;\n  };\n\n  VirtualDataSource.prototype.en = function (a) {\n    if (!this.di.containsKey(a)) {\n      this.di.addItem(a, 1);\n    } else {\n      this.di.item(a, this.di.item(a) + 1);\n    }\n  };\n\n  VirtualDataSource.prototype.el = function (a) {\n    if (this.di.containsKey(a)) {\n      this.di.item(a, this.di.item(a) - 1);\n\n      if (this.di.item(a) <= 0) {\n        this.di.removeItem(a);\n\n        if (this.actualDataProvider != null) {\n          this.actualDataProvider.removePageRequest(a);\n        }\n      }\n    }\n  };\n\n  VirtualDataSource.prototype.addCandidate = function (a, b) {\n    var c = false;\n\n    if (!this.dh.containsKey(a)) {\n      var d = new List$1(Number_$type, 0);\n      var e = this.transformPage(a);\n\n      for (var f = 0; f < e.length; f++) {\n        var g = e[f];\n\n        if (!this.da.d(g)) {\n          d.add(g);\n          this.en(g);\n          var h = this.di.item(g);\n\n          if (h == 1 && this.actualDataProvider != null) {\n            this.actualDataProvider.addPageRequest(g, b);\n          }\n\n          c = true;\n        }\n      }\n\n      if (d.count > 0) {\n        this.dh.addItem(a, d.toArray());\n      }\n    }\n\n    return c;\n  };\n\n  VirtualDataSource.prototype.removeCandidate = function (a) {\n    if (this.dh.containsKey(a)) {\n      for (var b = 0; b < this.dh.item(a).length; b++) {\n        var c = this.dh.item(a)[b];\n        this.el(c);\n      }\n\n      this.dh.removeItem(a);\n    }\n  };\n\n  VirtualDataSource.prototype.transformPage = function (a) {\n    var b = [a];\n\n    if (this.an && this.c9.q) {\n      var c = a * this.actualPageSize;\n      var d = c + this.actualPageSize - 1;\n      var e = this.c8(c);\n      var f = new List$1(Number_$type, 0);\n\n      for (var g = c; g <= d; g++) {\n        if (e == null) {\n          break;\n        }\n\n        if (g > e.ad) {\n          if (e.ae < this.c9.t.count - 1) {\n            e = this.c9.t._inner[e.ae + 1];\n          } else {\n            break;\n          }\n        }\n\n        if (!e.p || g >= e.af && g <= e.af + (e.v() - 1) + e.aa) {\n          continue;\n        }\n\n        var h = g - e.t;\n        var i = intDivide(h, this.actualPageSize);\n\n        if (!f.contains(i)) {\n          f.add(i);\n        }\n      }\n\n      b = f.toArray();\n    }\n\n    return b;\n  };\n\n  VirtualDataSource.prototype.getUnrealizedCount = function () {\n    var a = this.da.g * this.actualPageSize;\n    var b = this.actualCount - a;\n    return b;\n  };\n\n  VirtualDataSource.prototype.onSetItemOverride = function (a, b, c) {\n    _super.prototype.onSetItemOverride.call(this, a, b, c);\n\n    var d = this.cw(a);\n    var e = d[0];\n\n    if (this.da.d(e)) {\n      this.da.j(e);\n    }\n  };\n\n  VirtualDataSource.prototype.refreshInternalOverride = function () {\n    _super.prototype.refreshInternalOverride.call(this);\n\n    this.actualPageSizePopulated = false;\n    var a = this.actualCount != 0;\n    this.dc = true;\n\n    if (!this.dd) {\n      this.resetCache();\n\n      if (a) {\n        this.onClearItems();\n      }\n\n      this.cq = null;\n      this.cv = null;\n      this.d0 = 0;\n      this.c9.v();\n    } else {\n      this.dd = false;\n\n      if (a) {\n        this.onClearItems();\n      }\n    }\n\n    this.er();\n    this.c7.au();\n    this.dc = false;\n  };\n\n  VirtualDataSource.prototype.er = function () {\n    var e_1, _a;\n\n    if (this.actualDataProvider != null) {\n      try {\n        for (var _b = tslib_1.__values(fromEnum(this.dh.values)), _c = _b.next(); !_c.done; _c = _b.next()) {\n          var a = _c.value;\n\n          for (var c = 0; c < a.length; c++) {\n            var b = a[c];\n            this.actualDataProvider.addPageRequest(b, 1);\n          }\n        }\n      } catch (e_1_1) {\n        e_1 = {\n          error: e_1_1\n        };\n      } finally {\n        try {\n          if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n        } finally {\n          if (e_1) throw e_1.error;\n        }\n      }\n    }\n  };\n\n  VirtualDataSource.prototype.onClearItemsOverride = function () {\n    _super.prototype.onClearItemsOverride.call(this);\n\n    if (!this.dc) {\n      this.queueAutoRefresh();\n    }\n  };\n\n  VirtualDataSource.prototype.onInsertItemOverride = function (a, b) {\n    _super.prototype.onInsertItemOverride.call(this, a, b);\n\n    this.queueAutoRefresh();\n  };\n\n  VirtualDataSource.prototype.onRemoveItemOverride = function (a, b) {\n    _super.prototype.onRemoveItemOverride.call(this, a, b);\n\n    this.queueAutoRefresh();\n  };\n\n  VirtualDataSource.prototype.get_isItemIndexLookupSupported = function () {\n    return true;\n  };\n\n  VirtualDataSource.prototype.get_isKeyIndexLookupSupported = function () {\n    return true;\n  };\n\n  VirtualDataSource.prototype.indexOfItem = function (a) {\n    var b = this.da.b;\n    var c = b.o;\n    var d = b.q;\n    var e = d.count;\n    var f = b.p;\n\n    for (var g = 0; g < e; g++) {\n      if (f._inner[g]) {\n        continue;\n      }\n\n      var h = d._inner[g].b;\n      var i = h.count();\n\n      for (var j = 0; j < i; j++) {\n        if (this.df(h.getItemAtIndex(j), a)) {\n          var k = typeGetValue(c._inner[g]);\n          var l = k * this.actualPageSize;\n          return l + j;\n        }\n      }\n    }\n\n    if (this.actualDataProvider != null && this.actualDataProvider.isItemIndexLookupSupported) {\n      return this.actualDataProvider.indexOfItem(a);\n    }\n\n    return -1;\n  };\n\n  VirtualDataSource.prototype.df = function (a, b) {\n    if (a == null && b == null) {\n      return true;\n    }\n\n    if (a == null || b == null) {\n      return false;\n    }\n\n    return Base.equalsStatic(a, b);\n  };\n\n  VirtualDataSource.prototype.indexOfKey = function (a) {\n    var b = this.actualPrimaryKey;\n\n    if (b == null || b.length < 1 || this.actualBaseDataProvider == null) {\n      return -1;\n    }\n\n    this.ensureComparables(this.actualSchema);\n    var c = this.c6();\n\n    if (this.an && this.shouldEmitSectionHeaders && !this.isSectionContentVisible && this.isSectionHeaderNormalRow) {\n      if (this.c9.t.count > 0) {\n        for (var d = 0; d < this.c9.t.count; d++) {\n          var e = this.c9.t._inner[d];\n          var f = new DataSourceSpecialRow();\n\n          for (var g = 0; g < e.e.length; g++) {\n            var h = e.e[g];\n            var i = e.f[g];\n            f.setSectionValue(h, i);\n          }\n\n          if (c.i(f, a) == 0) {\n            return d;\n          }\n        }\n      }\n    }\n\n    var j = this.da.b;\n    var k = j.o;\n    var l = j.q;\n    var m = l.count;\n    var n = j.p;\n\n    for (var o = 0; o < m; o++) {\n      if (n._inner[o]) {\n        continue;\n      }\n\n      var p = l._inner[o].b;\n      var q = p.count();\n\n      for (var r = 0; r < q; r++) {\n        if (c.i(p.getItemAtIndex(r), a) == 0) {\n          var s = typeGetValue(k._inner[o]);\n          var t = s * this.actualPageSize;\n          return t + r;\n        }\n      }\n    }\n\n    if (this.actualDataProvider != null && this.actualDataProvider.isKeyIndexLookupSupported) {\n      return this.actualDataProvider.indexOfKey(a);\n    }\n\n    return -1;\n  };\n\n  VirtualDataSource.prototype.c6 = function () {\n    var a = new Array(this.actualPrimaryKey.length);\n\n    for (var b = 0; b < a.length; b++) {\n      a[b] = 0;\n    }\n\n    return new DataSourcePropertiesComparer(this.actualPrimaryKey, a, this.cu, this);\n  };\n\n  VirtualDataSource.prototype.getStickyRowPriority = function (a) {\n    var b = this.getRowType(a);\n\n    switch (b) {\n      case 1:\n        return 100 - this.getRowLevel(a);\n\n      case 2:\n        return 99 - this.getRowLevel(a);\n\n      case 3:\n      case 5:\n        return 2;\n\n      case 4:\n        return 3;\n    }\n\n    return 1;\n  };\n\n  VirtualDataSource.prototype.unpinRow = function (a) {\n    _super.prototype.unpinRow.call(this, a);\n  };\n\n  VirtualDataSource.prototype.pinRow = function (a) {\n    _super.prototype.pinRow.call(this, a);\n  };\n\n  VirtualDataSource.prototype.isRowPinned = function (a) {\n    return _super.prototype.isRowPinned.call(this, a);\n  };\n\n  VirtualDataSource.prototype.getStickyRowsInRange = function (a, b) {\n    if ((this.groupDescriptions == null || this.groupDescriptions.k.count == 0) && (this.summaryDescriptions == null || this.summaryDescriptions.k.count == 0)) {\n      return null;\n    }\n\n    var c = this.c8(a);\n    var d = this.c8(b);\n\n    if (this.c9.t.count > 0) {\n      if (this.c9.t.count == 1) {\n        c = this.c9.t._inner[0];\n        d = this.c9.t._inner[0];\n      } else {\n        c = this.c9.e(a);\n\n        if (c != null) {\n          while (c.z != -1) {\n            c = this.c9.t._inner[c.z];\n          }\n        }\n\n        d = this.c9.e(b);\n\n        if (b >= this.actualCount - this.d0) {\n          d = this.c9.d();\n        }\n      }\n    } else if (this.d0 > 0) {\n      var e = new List$1(Number_$type, 0);\n\n      for (var f = this.actualCount - this.d0; f < this.actualCount; f++) {\n        e.add(f);\n      }\n\n      return e.toArray();\n    }\n\n    if (c == null || d == null) {\n      return null;\n    }\n\n    if (c.ae == this.ds && c.aa == this.du && c.af == this.dv && c.ad == this.dt && c.ah == this.dx && c.ag == this.dw && d.ae == this.dk && d.aa == this.dm && d.af == this.dn && d.ad == this.dl && d.ah == this.dq && d.ag == this.dp && this.d0 == this.dr) {\n      return this.cr;\n    }\n\n    this.ds = c.ae;\n    this.dk = d.ae;\n    this.du = c.aa;\n    this.dm = d.aa;\n    this.dv = c.af;\n    this.dn = d.af;\n    this.dt = c.ad;\n    this.dl = d.ad;\n    this.dq = d.ah;\n    this.dp = d.ag;\n    this.dx = c.ah;\n    this.dw = c.ag;\n    this.dr = this.d0;\n    var g = new List$1(Number_$type, 0);\n\n    for (var h = c.ae; h <= d.ae; h++) {\n      var i = this.c9.t._inner[h];\n      var j = i.c.length;\n      var k = i.v();\n\n      if (this.shouldEmitSectionHeaders && this.an) {\n        for (var l = 0; l < i.c.length; l++) {\n          if (i.a[l] != null) {\n            var m = i.af + i.b[l];\n            g.add(m);\n          }\n\n          if (!i.c[l]) {\n            break;\n          }\n        }\n      }\n\n      if (i.p) {\n        for (var n = 0; n < i.ah; n++) {\n          g.add(i.af + n + k);\n        }\n\n        if (this.shouldEmitShiftedRows) {\n          for (var o = 0; o < i.aa; o++) {\n            g.add(i.af + o + j);\n          }\n        }\n\n        if (this.summaryScope == 0 || this.summaryScope == 2) {\n          if (this.includeSummaryRowsInSection && this.isSectionSummaryRowsAtBottom) {\n            for (var p = i.ag - 1; p >= 0; p--) {\n              if (this.shouldEmitSectionFooters) {\n                g.add(i.ad - k - p);\n              } else {\n                g.add(i.ad - p);\n              }\n            }\n          }\n        }\n      }\n\n      if (this.shouldEmitSectionFooters && this.an) {\n        for (var q = i.c.length - 1; q >= 0; q--) {\n          if (!i.c[q]) {\n            break;\n          }\n\n          g.add(i.ad - q);\n        }\n      }\n    }\n\n    for (var r = this.actualCount - this.d0; r < this.actualCount; r++) {\n      g.add(r);\n    }\n\n    this.cr = g.toArray();\n    return this.cr;\n  };\n\n  VirtualDataSource.prototype.isExclusivelySticky = function (a) {\n    var b = this.getRowType(a);\n    return b == 1 || b == 2 || b == 4 || this.isSectionSummaryRowsAtBottom && b == 5;\n  };\n\n  VirtualDataSource.prototype.getRowType = function (a) {\n    if (a < 0) {\n      return 0;\n    }\n\n    var b = this.getItemAtIndex(a);\n    var item_ = b;\n\n    if (item_ != null && item_.$$isSpecialRow !== undefined) {\n      var c = b.rowType;\n\n      if (this.isSectionHeaderNormalRow && c == 1) {\n        return 0;\n      }\n\n      return c;\n    }\n\n    return 0;\n  };\n\n  VirtualDataSource.prototype.getIsRowExpandedAtIndex = function (a) {\n    var b = this.c9.e(a);\n\n    if (b == null) {\n      b = this.c9.d();\n    }\n\n    for (var c = 0; c < b.a.length; c++) {\n      if (b.a[c] != null) {\n        if (a == b.af + b.b[c]) {\n          return b.c[c];\n        }\n      }\n    }\n\n    return _super.prototype.getIsRowExpandedAtIndex.call(this, a);\n  };\n\n  VirtualDataSource.prototype.setIsRowExpandedAtIndex = function (a, b) {\n    var c = this.c9.e(a);\n\n    if (c == null) {\n      c = this.c9.d();\n    }\n\n    for (var d = 0; d < c.a.length; d++) {\n      if (c.a[d] != null) {\n        if (a == c.af + c.b[d]) {\n          var e = false;\n          var f = c.a[d];\n\n          if (this.dg.containsKey(f) && this.dg.item(f) != b) {\n            var g = this.dg.item(f);\n\n            if (b == this.isSectionExpandedDefault) {\n              this.dg.removeItem(f);\n            } else {\n              this.dg.item(f, b);\n            }\n\n            e = true;\n            this.onRowExpansionChanged(a, g, b);\n          } else if (b != this.isSectionExpandedDefault) {\n            this.dg.addItem(f, b);\n            e = true;\n            this.onRowExpansionChanged(a, this.isSectionExpandedDefault, b);\n          }\n\n          if (e) {\n            this.c9.v();\n            this.ep();\n            this.dd = true;\n\n            if (this.actualCount != this.c9.u) {\n              this.actualCount = this.c9.u + this.d0;\n            } else {\n              this.queueAutoRefresh();\n            }\n          }\n\n          break;\n        }\n      }\n    }\n  };\n\n  VirtualDataSource.prototype.getRowLevel = function (a) {\n    if (a < 0) {\n      return 0;\n    }\n\n    var b = this.getItemAtIndex(a);\n    var item_ = b;\n\n    if (item_ != null && item_.$$isSpecialRow !== undefined) {\n      return b.level;\n    }\n\n    if (this.isGroupingSupported) {\n      if (this.sectionHeaderDisplayMode == 1) {\n        return this.groupDescriptions.k.count;\n      } else if (this.groupDescriptions.k.count > 0) {\n        return 1;\n      }\n    }\n\n    return 0;\n  };\n\n  VirtualDataSource.prototype.getRootSummaryRowCount = function () {\n    return this.d0;\n  };\n\n  VirtualDataSource.prototype.eb = function (a) {\n    var b = \"\";\n\n    for (var c = 0; c < a.e.length; c++) {\n      b += a.e[c] + \":\" + a.f[c];\n    }\n\n    return b;\n  };\n\n  VirtualDataSource.prototype.ec = function (a, b) {\n    if (this.sectionHeaderDisplayMode == 0) {\n      return this.eb(a);\n    }\n\n    var c = \"\";\n\n    for (var d = 0; d < a.e.length; d++) {\n      c += a.e[d] + \":\" + a.f[d] + \":\";\n    }\n\n    c += b;\n    return c;\n  };\n\n  VirtualDataSource.prototype.getRootSummaryResults = function () {\n    return this.cv;\n  };\n\n  VirtualDataSource.prototype.getSectionSummaryResults = function (a) {\n    if (this.c9.t.count > 0 && a >= 0 && a < this.c9.t.count) {\n      return this.c9.t._inner[a].i;\n    }\n\n    return null;\n  };\n\n  VirtualDataSource.prototype.clone = function () {\n    return null;\n  };\n\n  VirtualDataSource.prototype.cloneProperties = function (a) {\n    _super.prototype.cloneProperties.call(this, a);\n\n    var b = typeCast(VirtualDataSource.$, a);\n\n    if (b != null) {\n      b.pageSizeRequested = this.pageSizeRequested;\n      b.maxCachedPages = this.maxCachedPages;\n    }\n  };\n\n  Object.defineProperty(VirtualDataSource.prototype, \"concurrencyTag\", {\n    get: function () {\n      return this._concurrencyTag;\n    },\n    set: function (a) {\n      this._concurrencyTag = a;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  VirtualDataSource.prototype.get_isBatchingEnabled = function () {\n    return true;\n  };\n\n  VirtualDataSource.prototype.set_isBatchingEnabled = function (a) {\n    _super.prototype.set_isBatchingEnabled.call(this, a);\n  };\n\n  VirtualDataSource.prototype.updatePropertyAtKey = function (a, b, c, d) {\n    if (d === void 0) {\n      d = false;\n    }\n\n    var e = _super.prototype.updatePropertyAtKey.call(this, a, b, c);\n\n    if (this.concurrencyTag != null && this.ao()) {\n      var f = this.indexOfKey(a);\n\n      if (f > -1) {\n        var g = this.getItemAtIndex(f);\n        var h = this.actualDataProvider.getItemValue(g, this.concurrencyTag);\n\n        if (h != null) {\n          var i = this.t.g(a);\n          i.version = h;\n        }\n      }\n    }\n\n    return e;\n  };\n\n  VirtualDataSource.prototype.removeItemByKey = function (a) {\n    _super.prototype.removeItemByKey.call(this, a);\n\n    if (this.concurrencyTag != null && this.ao()) {\n      var b = this.indexOfKey(a);\n\n      if (b > -1) {\n        var c = this.getItemAtIndex(b);\n        var d = this.actualDataProvider.getItemValue(c, this.concurrencyTag);\n\n        if (d != null) {\n          var e = this.t.g(a);\n          e.version = d;\n        }\n      }\n    }\n  };\n\n  VirtualDataSource.prototype.cj = function (a, b) {\n    if (a == 5) {\n      var c = b;\n      var d_1 = c.a;\n      var e = new List$1(TransactionState.$, 0);\n\n      var _loop_1 = function (f) {\n        var e_2, _a, e_3, _b;\n\n        var g = d_1[f].transactionType;\n        var h = null;\n        var i = null;\n\n        if (g == TransactionType.Delete || g == 1) {\n          var j = new Dictionary$2(String_$type, Base.$, 0);\n          var k = d_1[f].id;\n\n          for (var l = 0; l < this_1.actualPrimaryKey.length; l++) {\n            j.addItem(this_1.actualPrimaryKey[l], k[l]);\n          }\n\n          h = j;\n        }\n\n        if (g == 0) {\n          var m = new Dictionary$2(String_$type, Base.$, 0);\n          var n = d_1[f].id[0];\n\n          for (var o = 0; o < this_1.actualSchema.propertyNames.length; o++) {\n            var p = this_1.actualSchema.propertyNames[o];\n            m.addItem(p, this_1.actualDataProvider.getItemValue(n, p));\n          }\n\n          i = m;\n        } else if (g == 1) {\n          i = d_1[f].value;\n        }\n\n        if (h != null) {\n          var q = {};\n          var r = h;\n\n          try {\n            for (var _c = (e_2 = void 0, tslib_1.__values(fromEnum(r))), _d = _c.next(); !_d.done; _d = _c.next()) {\n              var s = _d.value;\n              q[s.key] = s.value;\n            }\n          } catch (e_2_1) {\n            e_2 = {\n              error: e_2_1\n            };\n          } finally {\n            try {\n              if (_d && !_d.done && (_a = _c.return)) _a.call(_c);\n            } finally {\n              if (e_2) throw e_2.error;\n            }\n          }\n\n          h = q;\n        }\n\n        if (i != null) {\n          var t = {};\n          var u = i;\n\n          try {\n            for (var _e = (e_3 = void 0, tslib_1.__values(fromEnum(u))), _f = _e.next(); !_f.done; _f = _e.next()) {\n              var v = _f.value;\n              t[v.key] = v.value;\n            }\n          } catch (e_3_1) {\n            e_3 = {\n              error: e_3_1\n            };\n          } finally {\n            try {\n              if (_f && !_f.done && (_b = _e.return)) _b.call(_e);\n            } finally {\n              if (e_3) throw e_3.error;\n            }\n          }\n\n          i = t;\n        }\n\n        e.add(function () {\n          var $ret = new TransactionState(h, g, i);\n          $ret.version = d_1[f].version;\n          return $ret;\n        }());\n      };\n\n      var this_1 = this;\n\n      for (var f = 0; f < d_1.length; f++) {\n        _loop_1(f);\n      }\n\n      var w = e.toArray();\n\n      if (this.batchStarted != null) {\n        this.batchStarted(this, new DataSourceBatchStartedEventArgs(w));\n      }\n\n      this.actualDataProvider.createBatchRequest(w);\n    }\n  };\n\n  VirtualDataSource.prototype.ej = function (a, b, c) {\n    if (b) {\n      this.queueAutoRefresh();\n    }\n\n    if (this.batchCompleted != null) {\n      this.batchCompleted(this, new DataSourceBatchCompletedEventArgs(a, c));\n    }\n  };\n\n  VirtualDataSource.$t = markType(VirtualDataSource, 'VirtualDataSource', BaseDataSource.$, [IPageCandidatesSink_$type]);\n  return VirtualDataSource;\n}(BaseDataSource);\n\nexport { VirtualDataSource };","map":{"version":3,"sources":["../../../../src/igniteui-core/lib/VirtualDataSource.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["/*\r\nTHIS INFRAGISTICS ULTIMATE SOFTWARE LICENSE  AGREEMENT (\"AGREEMENT\") LOCATED HERE:\r\nhttps://www.infragistics.com/legal/license/igultimate-la\r\nhttps://www.infragistics.com/legal/license/igultimate-eula\r\nGOVERNS THE LICENSING, INSTALLATION AND USE OF INFRAGISTICS SOFTWARE. BY DOWNLOADING AND/OR INSTALLING AND USING INFRAGISTICS SOFTWARE:  you are indicating that you have read and understand this Agreement, and agree to be legally bound by it on behalf of the yourself and your company.\r\n*/\r\nimport * as tslib_1 from \"tslib\";\r\nimport { BaseDataSource } from \"./BaseDataSource\";\r\nimport { IPageCandidatesSink_$type } from \"./IPageCandidatesSink\";\r\nimport { PagePredictionEngine } from \"./PagePredictionEngine\";\r\nimport { LRUCache$2 } from \"./LRUCache$2\";\r\nimport { Base, runOn, Array_$type, Number_$type, typeCast, fromEnum, typeGetValue, String_$type, Boolean_$type, markType } from \"./type\";\r\nimport { IDataSourcePage_$type } from \"./IDataSourcePage\";\r\nimport { Dictionary$2 } from \"./Dictionary$2\";\r\nimport { SectionMap } from \"./SectionMap\";\r\nimport { DataSourceExecutionContext } from \"./DataSourceExecutionContext\";\r\nimport { SectionData } from \"./SectionData\";\r\nimport { List$1 } from \"./List$1\";\r\nimport { DataSourceSpecialRow } from \"./DataSourceSpecialRow\";\r\nimport { DataSourcePropertiesComparer } from \"./DataSourcePropertiesComparer\";\r\nimport { TransactionState } from \"./TransactionState\";\r\nimport { TransactionType } from \"./TransactionType\";\r\nimport { DataSourceBatchStartedEventArgs } from \"./DataSourceBatchStartedEventArgs\";\r\nimport { DataSourceBatchCompletedEventArgs } from \"./DataSourceBatchCompletedEventArgs\";\r\nimport { truncate, intDivide } from \"./number\";\r\n/**\r\n * @hidden\r\n */\r\nvar VirtualDataSource = /** @class */ /*@__PURE__*/ (function (_super) {\r\n    tslib_1.__extends(VirtualDataSource, _super);\r\n    function VirtualDataSource() {\r\n        var _this = _super.call(this) || this;\r\n        _this.cu = null;\r\n        _this.dd = false;\r\n        _this.d0 = 0;\r\n        _this.c7 = null;\r\n        _this.cy = null;\r\n        _this.cx = null;\r\n        _this.dz = 50;\r\n        _this.dy = 200;\r\n        _this.actualPageSizePopulated = false;\r\n        _this.dj = 50;\r\n        _this.db = false;\r\n        _this.c2 = null;\r\n        _this.cs = null;\r\n        _this.ct = null;\r\n        _this.da = new LRUCache$2(Base.$, IDataSourcePage_$type, 0, 200);\r\n        _this.dh = new Dictionary$2(Base.$, Array_$type, 0);\r\n        _this.di = new Dictionary$2(Number_$type, Number_$type, 0);\r\n        _this.dc = false;\r\n        _this.cq = null;\r\n        _this.cv = null;\r\n        _this.c9 = new SectionMap();\r\n        _this.cr = null;\r\n        _this.ds = -1;\r\n        _this.dk = -1;\r\n        _this.du = -1;\r\n        _this.dm = -1;\r\n        _this.dv = -1;\r\n        _this.dn = -1;\r\n        _this.dt = -1;\r\n        _this.dl = -1;\r\n        _this.dx = -1;\r\n        _this.dw = -1;\r\n        _this.dq = -1;\r\n        _this.dp = -1;\r\n        _this.dr = -1;\r\n        _this.dg = new Dictionary$2(String_$type, Boolean_$type, 0);\r\n        _this._concurrencyTag = null;\r\n        _this.batchStarted = null;\r\n        _this.batchCompleted = null;\r\n        _this.c7 = new PagePredictionEngine();\r\n        _this.c7.e = _this;\r\n        _this.c7.ag = _this.actualPageSize;\r\n        _this.c7.f = _this.c9;\r\n        _this.executionContext = new DataSourceExecutionContext();\r\n        _this.c7.b = _this.executionContext;\r\n        _this.isReadOnly = true;\r\n        return _this;\r\n    }\r\n    VirtualDataSource.prototype.get_isSectionCollapsable = function () {\r\n        if (!this.isSectionContentVisible) {\r\n            return true;\r\n        }\r\n        return _super.prototype.get_isSectionCollapsable.call(this);\r\n    };\r\n    VirtualDataSource.prototype.set_isSectionCollapsable = function (a) {\r\n        _super.prototype.set_isSectionCollapsable.call(this, a);\r\n    };\r\n    VirtualDataSource.prototype.get_isSectionExpandedDefault = function () {\r\n        if (!this.isSectionContentVisible) {\r\n            return false;\r\n        }\r\n        if (this.isSectionCollapsable) {\r\n            return _super.prototype.get_isSectionExpandedDefault.call(this);\r\n        }\r\n        return true;\r\n    };\r\n    VirtualDataSource.prototype.set_isSectionExpandedDefault = function (a) {\r\n        _super.prototype.set_isSectionExpandedDefault.call(this, a);\r\n    };\r\n    VirtualDataSource.prototype.get_actualBaseDataProvider = function () {\r\n        return this.actualDataProvider;\r\n    };\r\n    Object.defineProperty(VirtualDataSource.prototype, \"actualBaseDataProvider\", {\r\n        get: function () {\r\n            return this.get_actualBaseDataProvider();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(VirtualDataSource.prototype, \"dataProvider\", {\r\n        get: function () {\r\n            return this.cy;\r\n        },\r\n        set: function (a) {\r\n            var b = this.cy;\r\n            this.cy = a;\r\n            if (b != this.cy) {\r\n                this.onPropertyUpdated(\"DataProvider\", b, this.cy);\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(VirtualDataSource.prototype, \"actualDataProvider\", {\r\n        get: function () {\r\n            if (this.cx == null) {\r\n                this.actualDataProvider = this.resolveDataProvider();\r\n            }\r\n            return this.cx;\r\n        },\r\n        set: function (a) {\r\n            var b = this.cx;\r\n            this.cx = a;\r\n            if (b != this.cx) {\r\n                this.onPropertyUpdated(\"ActualDataProvider\", b, this.cx);\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(VirtualDataSource.prototype, \"pageSizeRequested\", {\r\n        get: function () {\r\n            return this.dz;\r\n        },\r\n        set: function (a) {\r\n            var b = this.dz;\r\n            this.dz = a;\r\n            if (b != this.dz) {\r\n                this.onPropertyUpdated(\"PageSizeRequested\", b, this.dz);\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    VirtualDataSource.prototype.resetCache = function () {\r\n        if (this.c3 != null) {\r\n            this.c3.resetCache();\r\n        }\r\n        this.resetCacheOverride();\r\n    };\r\n    VirtualDataSource.prototype.resetCacheOverride = function () {\r\n        this.da.i();\r\n    };\r\n    Object.defineProperty(VirtualDataSource.prototype, \"maxCachedPages\", {\r\n        get: function () {\r\n            return this.dy;\r\n        },\r\n        set: function (a) {\r\n            var b = this.dy;\r\n            this.dy = a;\r\n            if (b != this.dy) {\r\n                this.onPropertyUpdated(\"MaxCachedPages\", b, this.dy);\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(VirtualDataSource.prototype, \"actualPageSize\", {\r\n        get: function () {\r\n            return this.dj;\r\n        },\r\n        set: function (a) {\r\n            var b = this.dj;\r\n            this.dj = a;\r\n            if (b != this.dj) {\r\n                this.onPropertyUpdated(\"ActualPageSize\", b, this.dj);\r\n            }\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    VirtualDataSource.prototype.get_isSortingSupported = function () {\r\n        if (this.externalDataSource != null && !this.db) {\r\n            this.db = true;\r\n            var a = this.externalDataSource.isSortingSupportedOverride;\r\n            this.db = false;\r\n            return a;\r\n        }\r\n        return false;\r\n    };\r\n    VirtualDataSource.prototype.get_isFilteringSupported = function () {\r\n        if (this.externalDataSource != null && !this.db) {\r\n            this.db = true;\r\n            var a = this.externalDataSource.isFilteringSupportedOverride;\r\n            this.db = false;\r\n            return a;\r\n        }\r\n        return false;\r\n    };\r\n    VirtualDataSource.prototype.get_isGroupingSupported = function () {\r\n        if (this.externalDataSource != null && !this.db) {\r\n            this.db = true;\r\n            var a = this.externalDataSource.isGroupingSupportedOverride;\r\n            this.db = false;\r\n            return a;\r\n        }\r\n        return false;\r\n    };\r\n    Object.defineProperty(VirtualDataSource.prototype, \"c3\", {\r\n        get: function () {\r\n            return this.c2;\r\n        },\r\n        set: function (a) {\r\n            this.c2 = a;\r\n            this.actualDataProvider = this.resolveDataProvider();\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    VirtualDataSource.prototype.resolveDataProvider = function () {\r\n        if (this.c3 == null) {\r\n            return null;\r\n        }\r\n        return this.c3.resolveDataProvider();\r\n    };\r\n    VirtualDataSource.prototype.propertyUpdatedOverride = function (a, b, c) {\r\n        _super.prototype.propertyUpdatedOverride.call(this, a, b, c);\r\n        switch (a) {\r\n            case \"DataProvider\":\r\n                this.actualDataProvider = this.dataProvider;\r\n                this.queueAutoRefresh();\r\n                break;\r\n            case \"ExecutionContext\":\r\n                this.c7.b = this.executionContext;\r\n                break;\r\n            case \"ActualDataProvider\":\r\n                this.actualDataProvider.pageSizeRequested = this.pageSizeRequested;\r\n                this.actualDataProvider.pageLoaded = runOn(this, this.ek);\r\n                this.actualDataProvider.batchCompleted = runOn(this, this.ej);\r\n                this.queueAutoRefresh();\r\n                break;\r\n            case \"PageSizeRequested\":\r\n                this.actualPageSize = this.pageSizeRequested;\r\n                if (this.actualDataProvider != null) {\r\n                    this.actualDataProvider.pageSizeRequested = this.pageSizeRequested;\r\n                }\r\n                this.queueAutoRefresh();\r\n                break;\r\n            case \"ActualPageSize\":\r\n                this.c7.ag = this.actualPageSize;\r\n                this.queueAutoRefresh();\r\n                break;\r\n            case \"FirstVisibleIndexRequested\":\r\n                this.c7.aa = this.firstVisibleIndexRequested;\r\n                break;\r\n            case \"LastVisibleIndexRequested\":\r\n                this.c7.ae = this.lastVisibleIndexRequested;\r\n                break;\r\n            case \"ActualCount\":\r\n                if (this.actualDataProvider != null && !this.c9.q) {\r\n                    this.c7.ab = this.actualDataProvider.actualCount;\r\n                }\r\n                else {\r\n                    this.c7.ab = this.actualCount;\r\n                }\r\n                this.queueAutoRefresh();\r\n                break;\r\n            case \"MaxCachedPages\":\r\n                this.da.h = this.maxCachedPages;\r\n                break;\r\n        }\r\n    };\r\n    VirtualDataSource.prototype.d3 = function (a) {\r\n        if (this.an && this.c9.q) {\r\n            var b = this.c8(a);\r\n            if (b == null) {\r\n                b = this.c9.d();\r\n            }\r\n            return a - b.t;\r\n        }\r\n        return a;\r\n    };\r\n    VirtualDataSource.prototype.ek = function (a, b, c) {\r\n        var _this = this;\r\n        var d = this.executionContext;\r\n        if (d != null) {\r\n            d.execute(function () { return _this.eq(a, b, c); });\r\n        }\r\n        else {\r\n            this.eq(a, b, c);\r\n        }\r\n    };\r\n    VirtualDataSource.prototype.eq = function (a, b, c) {\r\n        if (a == null) {\r\n            b = this.resolveFullCount(b);\r\n            if (this.actualCount != b) {\r\n                this.actualCount = b;\r\n            }\r\n            return;\r\n        }\r\n        if (c != this.actualPageSize && !this.actualPageSizePopulated) {\r\n            this.actualPageSize = c;\r\n        }\r\n        this.actualPageSizePopulated = true;\r\n        var d = a.pageIndex();\r\n        this.el(d);\r\n        this.da.item(d, a);\r\n        var e = a.schema();\r\n        if (e != null) {\r\n            this.actualSchema = e;\r\n        }\r\n        var f = a.getSummaryInformation();\r\n        if (this.summaryDescriptions.k.count > 0 && this.cv == null && f != null) {\r\n            this.cv = f;\r\n            for (var g = 0; g < this.summaryDescriptions.k.count; g++) {\r\n                this.cv[g].summaryIndex = g;\r\n            }\r\n            var h = SectionData.r(this.cv);\r\n            this.d0 = h.count;\r\n        }\r\n        var i = a.getGroupInformation();\r\n        if (this.groupDescriptions.k.count > 0 && this.cq == null && i != null) {\r\n            this.cq = i;\r\n            this.ep();\r\n            this.dd = false;\r\n        }\r\n        b = this.resolveFullCount(b);\r\n        if (this.actualCount != b) {\r\n            this.actualCount = b;\r\n        }\r\n        this.eo(a);\r\n    };\r\n    VirtualDataSource.prototype.resolveFullCount = function (a) {\r\n        if (this.cq != null) {\r\n            return this.c9.u + this.d0;\r\n        }\r\n        return a + this.d0;\r\n    };\r\n    VirtualDataSource.prototype.ep = function () {\r\n        var a = 0;\r\n        var b = 0;\r\n        var c = this.shouldEmitSectionHeaders;\r\n        var d = this.shouldEmitSectionFooters;\r\n        for (var e = 0; e < this.cq.length; e++) {\r\n            var f = new SectionData();\r\n            var g = b;\r\n            var h = this.cq[e].endIndex - this.cq[e].startIndex;\r\n            f.af = a;\r\n            f.ae = e;\r\n            f.d = new Array(this.groupDescriptions.k.count);\r\n            for (var i = 0; i < this.groupDescriptions.k.count; i++) {\r\n                f.d[i] = 0;\r\n            }\r\n            f.ad = a + h;\r\n            f.t = 0;\r\n            f.e = this.cq[e].groupKeyProperties;\r\n            f.f = this.cq[e].groupKeyValues;\r\n            f.h = new Array(0);\r\n            f.ai(this.sectionHeaderDisplayMode, this.isSectionExpandedDefault);\r\n            this.ei(f, e == 0);\r\n            if (d) {\r\n                f.u = f.c.length;\r\n            }\r\n            var j = 0;\r\n            f.i = new Array(this.groupDescriptions.k.count);\r\n            if (this.summaryScope == 0 || this.summaryScope == 2) {\r\n                if (this.cq[e].summaryResults != null) {\r\n                    f.i[this.groupDescriptions.k.count - 1] = this.cq[e].summaryResults;\r\n                    if (f.i != null) {\r\n                        for (var k = 0; k < f.i[this.groupDescriptions.k.count - 1].length; k++) {\r\n                            f.i[this.groupDescriptions.k.count - 1][k].summaryIndex = k;\r\n                        }\r\n                        j = SectionData.r(f.i[this.groupDescriptions.k.count - 1]).count;\r\n                    }\r\n                }\r\n            }\r\n            if (this.includeSummaryRowsInSection) {\r\n                if (this.isSectionSummaryRowsAtBottom) {\r\n                    f.ag = j;\r\n                }\r\n                else {\r\n                    f.ah = j;\r\n                    g += j;\r\n                }\r\n                b += j;\r\n                f.ad += j;\r\n            }\r\n            if (d) {\r\n                b++;\r\n            }\r\n            var l = 0;\r\n            f.b = new Array(f.c.length);\r\n            if (f.z > -1) {\r\n                var m = this.c9.t._inner[f.z];\r\n                for (var n = 0; n < m.f.length; n++) {\r\n                    l = n;\r\n                    if (!Base.equalsStatic(m.f[n], f.f[n])) {\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            for (var o = l; o < f.c.length; o++) {\r\n                b++;\r\n                g++;\r\n                f.ad++;\r\n                var p = this.ec(f, o);\r\n                f.a[o] = p;\r\n                f.b[o] = o - l;\r\n                if (this.dg.containsKey(p)) {\r\n                    f.c[o] = this.dg.item(p);\r\n                }\r\n                else {\r\n                    f.c[o] = this.isSectionExpandedDefault;\r\n                }\r\n                if (!f.c[o]) {\r\n                    var q = 0;\r\n                    var r = f.c.length - 1 - o;\r\n                    f.ad -= q;\r\n                    b -= q;\r\n                    if (d) {\r\n                        b--;\r\n                        f.u--;\r\n                    }\r\n                    o += r;\r\n                }\r\n            }\r\n            f.y = f.v();\r\n            f.t = g;\r\n            this.c9.z(f, h + 1);\r\n            if (!f.p) {\r\n                var s = f.w();\r\n                f.ad -= f.d[s] + j;\r\n                b -= f.d[s] + j;\r\n            }\r\n            a = f.ad + 1;\r\n            this.c9.t.add(f);\r\n            f.q = this.c9.r(f);\r\n        }\r\n        var t = 0;\r\n        for (var u = 0; u < this.c9.t.count; u++) {\r\n            var v = this.c9.t._inner[u];\r\n            if (this.shouldEmitSectionHeaders) {\r\n                if (!v.q) {\r\n                    var w = v.ad - v.af + 1;\r\n                    this.c9.ae(v.ae);\r\n                    this.c9.ab(v, -w, -w);\r\n                    u--;\r\n                    t++;\r\n                    continue;\r\n                }\r\n            }\r\n            if (v.z > -1) {\r\n                v.z -= t;\r\n            }\r\n        }\r\n    };\r\n    VirtualDataSource.prototype.ei = function (a, b) {\r\n        if (b) {\r\n            this.cs = new Array(this.groupDescriptions.k.count);\r\n            for (var c = 0; c < this.cs.length; c++) {\r\n                this.cs[c] = a;\r\n            }\r\n        }\r\n        if (this.sectionHeaderDisplayMode == 1) {\r\n            var d = false;\r\n            var e = a.e.length;\r\n            for (var f = 0; f < e; f++) {\r\n                if (d) {\r\n                    this.cs[f] = a;\r\n                    continue;\r\n                }\r\n                var g = false;\r\n                if (this.cs[f].f[f] == null) {\r\n                    g = a.f[f] != null;\r\n                }\r\n                else {\r\n                    g = !Base.equalsStatic(this.cs[f].f[f], a.f[f]);\r\n                }\r\n                if (g) {\r\n                    this.cs[f] = a;\r\n                    if (f - 1 > -1) {\r\n                        var h = f - 1;\r\n                        while (h >= 0 && this.cs[h].o) {\r\n                            h = h - 1;\r\n                        }\r\n                        a.z = this.cs[h].ae;\r\n                    }\r\n                    d = true;\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            var i = false;\r\n            for (var j = 0; j < a.e.length; j++) {\r\n                if (this.cs[0].f[j] == null) {\r\n                    if (this.cs[0].f[j] != a.f[j]) {\r\n                        i = true;\r\n                        break;\r\n                    }\r\n                    continue;\r\n                }\r\n                if (!Base.equalsStatic(this.cs[0].f[j], a.f[j])) {\r\n                    i = true;\r\n                    break;\r\n                }\r\n            }\r\n            if (i) {\r\n                this.cs[0] = a;\r\n            }\r\n        }\r\n    };\r\n    VirtualDataSource.prototype.eh = function (a) {\r\n    };\r\n    VirtualDataSource.prototype.eo = function (a) {\r\n        if (this.updateNotifier != null) {\r\n            var b = a.pageIndex() * this.actualPageSize;\r\n            if (this.actualDataProvider != null) {\r\n                if (b > this.actualDataProvider.actualCount) {\r\n                    return;\r\n                }\r\n            }\r\n            var c = this.d2(b);\r\n            var d = this.d2(b + a.count() - 1);\r\n            if (c > 0 && this.getRowType(c - 1) == 1) {\r\n                c--;\r\n            }\r\n            if (this.actualCount == 0 && a.count() == 0) {\r\n                this.onClearItems();\r\n            }\r\n            else {\r\n                this.updateNotifier.rangeActualized(c, d);\r\n            }\r\n        }\r\n    };\r\n    VirtualDataSource.prototype.d2 = function (a) {\r\n        if (this.an && this.c9.q) {\r\n            var b = this.c9.g(a);\r\n            if (b == null) {\r\n                b = this.c9.d();\r\n            }\r\n            if (!b.p) {\r\n                return b.af;\r\n            }\r\n            return a + b.t;\r\n        }\r\n        return a;\r\n    };\r\n    VirtualDataSource.prototype.em = function (a) {\r\n        a();\r\n    };\r\n    VirtualDataSource.prototype.get_isVirtual = function () {\r\n        return true;\r\n    };\r\n    VirtualDataSource.prototype.isPlaceholderItem = function (a) {\r\n        var b = this.cw(a);\r\n        var c = b[0];\r\n        if (!this.da.d(c)) {\r\n            if (b[1] == -1) {\r\n                return false;\r\n            }\r\n            return true;\r\n        }\r\n        return false;\r\n    };\r\n    VirtualDataSource.prototype.getItemAtIndex = function (a) {\r\n        if (a >= this.actualCount - this.d0) {\r\n            return this.d7(a);\r\n        }\r\n        var b = this.cw(a);\r\n        var c = b[0];\r\n        if (!this.da.d(c)) {\r\n            if (b[1] == -1) {\r\n                return this.d7(a);\r\n            }\r\n            return null;\r\n        }\r\n        var d = this.da.item(c);\r\n        var e = b[1];\r\n        if (e == -1) {\r\n            return this.d7(a);\r\n        }\r\n        return d.getItemAtIndex(e);\r\n    };\r\n    VirtualDataSource.prototype.d7 = function (a) {\r\n        if (a >= this.actualCount - this.d0) {\r\n            var b = new DataSourceSpecialRow();\r\n            b.rowType = 4;\r\n            b.level = 0;\r\n            var c = a - (this.actualCount - this.d0);\r\n            var d = SectionData.r(this.cv);\r\n            var e = new Array(d._inner[c].count);\r\n            d._inner[c].values.copyTo(e, 0);\r\n            b.summaryResults = e;\r\n            return b;\r\n        }\r\n        var f = this.c8(a);\r\n        if (f != null) {\r\n            var g = f.j(a);\r\n            if (g == 1 || g == 2) {\r\n                var h = new DataSourceSpecialRow();\r\n                h.rowType = g;\r\n                h.summaryResults = f.i[f.i.length - 1];\r\n                h.level = g == 1 ? f.w() + (a - f.af) : (f.u - 1) - (f.w() + (a - (f.ad - f.u + 1)));\r\n                if (this.sectionHeaderDisplayMode == 0) {\r\n                    for (var i = 0; i < this.groupDescriptions.k.count; i++) {\r\n                        h.setSectionValue(this.groupDescriptions.k.item(i).propertyName, f.f[i]);\r\n                        h.setValue(this.groupDescriptions.k.item(i).propertyName, f.f[i]);\r\n                    }\r\n                }\r\n                else {\r\n                    if (h.level >= 0 && h.level < this.groupDescriptions.k.count) {\r\n                        h.setSectionValue(this.groupDescriptions.k.item(h.level).propertyName, f.f[h.level]);\r\n                        h.setValue(this.groupDescriptions.k.item(h.level).propertyName, f.f[h.level]);\r\n                    }\r\n                }\r\n                return h;\r\n            }\r\n            else if (g == 5) {\r\n                var j = new DataSourceSpecialRow();\r\n                j.rowType = 5;\r\n                j.level = f.c.length;\r\n                var k = f.x(a);\r\n                var l = SectionData.r(f.i[f.i.length - 1]);\r\n                var m = new Array(l._inner[k].count);\r\n                l._inner[k].values.copyTo(m, 0);\r\n                j.summaryResults = m;\r\n                return j;\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    VirtualDataSource.prototype.cw = function (a) {\r\n        if (this.an && this.c9.q) {\r\n            var b = false;\r\n            var c = this.c8(a);\r\n            if (c == null) {\r\n                c = this.c9.d();\r\n                if (this.cv.length > 0 && a > c.ad) {\r\n                    b = true;\r\n                }\r\n            }\r\n            var d = c.af;\r\n            if (this.shouldEmitSectionHeaders && a >= d && a < d + c.v()) {\r\n                b = true;\r\n            }\r\n            if (a - (d + c.v() - 1) <= c.aa + c.ah) {\r\n                b = true;\r\n            }\r\n            if (this.shouldEmitSectionFooters) {\r\n                if (a <= c.ad && a >= c.ad - c.c.length - c.ag) {\r\n                    b = true;\r\n                }\r\n            }\r\n            else if (c.ag > 0) {\r\n                if (a > c.ad - c.ag && a <= c.ad) {\r\n                    b = true;\r\n                }\r\n            }\r\n            var e = a - c.t;\r\n            var f = truncate(Math.floor(e / this.actualPageSize));\r\n            var g = e % this.actualPageSize;\r\n            if (b) {\r\n                g = -1;\r\n            }\r\n            var h = new Array(2);\r\n            h[0] = f;\r\n            h[1] = g;\r\n            return h;\r\n        }\r\n        else {\r\n            var i = truncate(Math.floor(a / this.actualPageSize));\r\n            var j = a % this.actualPageSize;\r\n            var k = new Array(2);\r\n            k[0] = i;\r\n            k[1] = j;\r\n            return k;\r\n        }\r\n    };\r\n    VirtualDataSource.prototype.c8 = function (a) {\r\n        return this.c9.e(a);\r\n    };\r\n    VirtualDataSource.prototype.getItemPropertyAtIndex = function (a, b) {\r\n        if (a > (this.actualCount - 1) - this.d0) {\r\n            return this.d8(a, b);\r\n        }\r\n        var c = this.cw(a);\r\n        var d = c[0];\r\n        if (!this.da.d(d)) {\r\n            if (c[1] == -1) {\r\n                return this.d8(a, b);\r\n            }\r\n            return null;\r\n        }\r\n        var e = this.da.item(d);\r\n        var f = c[1];\r\n        if (f == -1) {\r\n            return this.d8(a, b);\r\n        }\r\n        if (this.ao()) {\r\n            var g = e.getItemAtIndex(f);\r\n            var h = this.al(g, b);\r\n            if (h) {\r\n                var i = this.ay(g, b);\r\n                return i;\r\n            }\r\n        }\r\n        return e.getItemValueAtIndex(f, b);\r\n    };\r\n    VirtualDataSource.prototype.d8 = function (a, b) {\r\n        var c = this.d7(a);\r\n        if (typeCast(DataSourceSpecialRow.$, c) !== null) {\r\n            return c.getValue(b);\r\n        }\r\n        return null;\r\n    };\r\n    VirtualDataSource.prototype.en = function (a) {\r\n        if (!this.di.containsKey(a)) {\r\n            this.di.addItem(a, 1);\r\n        }\r\n        else {\r\n            this.di.item(a, this.di.item(a) + 1);\r\n        }\r\n    };\r\n    VirtualDataSource.prototype.el = function (a) {\r\n        if (this.di.containsKey(a)) {\r\n            this.di.item(a, this.di.item(a) - 1);\r\n            if (this.di.item(a) <= 0) {\r\n                this.di.removeItem(a);\r\n                if (this.actualDataProvider != null) {\r\n                    this.actualDataProvider.removePageRequest(a);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    VirtualDataSource.prototype.addCandidate = function (a, b) {\r\n        var c = false;\r\n        if (!this.dh.containsKey(a)) {\r\n            var d = new List$1(Number_$type, 0);\r\n            var e = this.transformPage(a);\r\n            for (var f = 0; f < e.length; f++) {\r\n                var g = e[f];\r\n                if (!this.da.d(g)) {\r\n                    d.add(g);\r\n                    this.en(g);\r\n                    var h = this.di.item(g);\r\n                    if (h == 1 && this.actualDataProvider != null) {\r\n                        this.actualDataProvider.addPageRequest(g, b);\r\n                    }\r\n                    c = true;\r\n                }\r\n            }\r\n            if (d.count > 0) {\r\n                this.dh.addItem(a, d.toArray());\r\n            }\r\n        }\r\n        return c;\r\n    };\r\n    VirtualDataSource.prototype.removeCandidate = function (a) {\r\n        if (this.dh.containsKey(a)) {\r\n            for (var b = 0; b < this.dh.item(a).length; b++) {\r\n                var c = this.dh.item(a)[b];\r\n                this.el(c);\r\n            }\r\n            this.dh.removeItem(a);\r\n        }\r\n    };\r\n    VirtualDataSource.prototype.transformPage = function (a) {\r\n        var b = [a];\r\n        if (this.an && this.c9.q) {\r\n            var c = a * this.actualPageSize;\r\n            var d = c + this.actualPageSize - 1;\r\n            var e = this.c8(c);\r\n            var f = new List$1(Number_$type, 0);\r\n            for (var g = c; g <= d; g++) {\r\n                if (e == null) {\r\n                    break;\r\n                }\r\n                if (g > e.ad) {\r\n                    if (e.ae < this.c9.t.count - 1) {\r\n                        e = this.c9.t._inner[e.ae + 1];\r\n                    }\r\n                    else {\r\n                        break;\r\n                    }\r\n                }\r\n                if (!e.p || (g >= e.af && g <= e.af + (e.v() - 1) + e.aa)) {\r\n                    continue;\r\n                }\r\n                var h = g - e.t;\r\n                var i = intDivide(h, this.actualPageSize);\r\n                if (!f.contains(i)) {\r\n                    f.add(i);\r\n                }\r\n            }\r\n            b = f.toArray();\r\n        }\r\n        return b;\r\n    };\r\n    VirtualDataSource.prototype.getUnrealizedCount = function () {\r\n        var a = this.da.g * this.actualPageSize;\r\n        var b = this.actualCount - a;\r\n        return b;\r\n    };\r\n    VirtualDataSource.prototype.onSetItemOverride = function (a, b, c) {\r\n        _super.prototype.onSetItemOverride.call(this, a, b, c);\r\n        var d = this.cw(a);\r\n        var e = d[0];\r\n        if (this.da.d(e)) {\r\n            this.da.j(e);\r\n        }\r\n    };\r\n    VirtualDataSource.prototype.refreshInternalOverride = function () {\r\n        _super.prototype.refreshInternalOverride.call(this);\r\n        this.actualPageSizePopulated = false;\r\n        var a = this.actualCount != 0;\r\n        this.dc = true;\r\n        if (!this.dd) {\r\n            this.resetCache();\r\n            if (a) {\r\n                this.onClearItems();\r\n            }\r\n            this.cq = null;\r\n            this.cv = null;\r\n            this.d0 = 0;\r\n            this.c9.v();\r\n        }\r\n        else {\r\n            this.dd = false;\r\n            if (a) {\r\n                this.onClearItems();\r\n            }\r\n        }\r\n        this.er();\r\n        this.c7.au();\r\n        this.dc = false;\r\n    };\r\n    VirtualDataSource.prototype.er = function () {\r\n        var e_1, _a;\r\n        if (this.actualDataProvider != null) {\r\n            try {\r\n                for (var _b = tslib_1.__values(fromEnum(this.dh.values)), _c = _b.next(); !_c.done; _c = _b.next()) {\r\n                    var a = _c.value;\r\n                    for (var c = 0; c < a.length; c++) {\r\n                        var b = a[c];\r\n                        this.actualDataProvider.addPageRequest(b, 1);\r\n                    }\r\n                }\r\n            }\r\n            catch (e_1_1) {\r\n                e_1 = { error: e_1_1 };\r\n            }\r\n            finally {\r\n                try {\r\n                    if (_c && !_c.done && (_a = _b.return))\r\n                        _a.call(_b);\r\n                }\r\n                finally {\r\n                    if (e_1)\r\n                        throw e_1.error;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    VirtualDataSource.prototype.onClearItemsOverride = function () {\r\n        _super.prototype.onClearItemsOverride.call(this);\r\n        if (!this.dc) {\r\n            this.queueAutoRefresh();\r\n        }\r\n    };\r\n    VirtualDataSource.prototype.onInsertItemOverride = function (a, b) {\r\n        _super.prototype.onInsertItemOverride.call(this, a, b);\r\n        this.queueAutoRefresh();\r\n    };\r\n    VirtualDataSource.prototype.onRemoveItemOverride = function (a, b) {\r\n        _super.prototype.onRemoveItemOverride.call(this, a, b);\r\n        this.queueAutoRefresh();\r\n    };\r\n    VirtualDataSource.prototype.get_isItemIndexLookupSupported = function () {\r\n        return true;\r\n    };\r\n    VirtualDataSource.prototype.get_isKeyIndexLookupSupported = function () {\r\n        return true;\r\n    };\r\n    VirtualDataSource.prototype.indexOfItem = function (a) {\r\n        var b = this.da.b;\r\n        var c = b.o;\r\n        var d = b.q;\r\n        var e = d.count;\r\n        var f = b.p;\r\n        for (var g = 0; g < e; g++) {\r\n            if (f._inner[g]) {\r\n                continue;\r\n            }\r\n            var h = d._inner[g].b;\r\n            var i = h.count();\r\n            for (var j = 0; j < i; j++) {\r\n                if (this.df(h.getItemAtIndex(j), a)) {\r\n                    var k = typeGetValue(c._inner[g]);\r\n                    var l = k * this.actualPageSize;\r\n                    return l + j;\r\n                }\r\n            }\r\n        }\r\n        if (this.actualDataProvider != null && this.actualDataProvider.isItemIndexLookupSupported) {\r\n            return this.actualDataProvider.indexOfItem(a);\r\n        }\r\n        return -1;\r\n    };\r\n    VirtualDataSource.prototype.df = function (a, b) {\r\n        if (a == null && b == null) {\r\n            return true;\r\n        }\r\n        if (a == null || b == null) {\r\n            return false;\r\n        }\r\n        return Base.equalsStatic(a, b);\r\n    };\r\n    VirtualDataSource.prototype.indexOfKey = function (a) {\r\n        var b = this.actualPrimaryKey;\r\n        if (b == null || b.length < 1 || this.actualBaseDataProvider == null) {\r\n            return -1;\r\n        }\r\n        this.ensureComparables(this.actualSchema);\r\n        var c = this.c6();\r\n        if (this.an && this.shouldEmitSectionHeaders && !this.isSectionContentVisible && this.isSectionHeaderNormalRow) {\r\n            if (this.c9.t.count > 0) {\r\n                for (var d = 0; d < this.c9.t.count; d++) {\r\n                    var e = this.c9.t._inner[d];\r\n                    var f = new DataSourceSpecialRow();\r\n                    for (var g = 0; g < e.e.length; g++) {\r\n                        var h = e.e[g];\r\n                        var i = e.f[g];\r\n                        f.setSectionValue(h, i);\r\n                    }\r\n                    if (c.i(f, a) == 0) {\r\n                        return d;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        var j = this.da.b;\r\n        var k = j.o;\r\n        var l = j.q;\r\n        var m = l.count;\r\n        var n = j.p;\r\n        for (var o = 0; o < m; o++) {\r\n            if (n._inner[o]) {\r\n                continue;\r\n            }\r\n            var p = l._inner[o].b;\r\n            var q = p.count();\r\n            for (var r = 0; r < q; r++) {\r\n                if (c.i(p.getItemAtIndex(r), a) == 0) {\r\n                    var s = typeGetValue(k._inner[o]);\r\n                    var t = s * this.actualPageSize;\r\n                    return t + r;\r\n                }\r\n            }\r\n        }\r\n        if (this.actualDataProvider != null && this.actualDataProvider.isKeyIndexLookupSupported) {\r\n            return this.actualDataProvider.indexOfKey(a);\r\n        }\r\n        return -1;\r\n    };\r\n    VirtualDataSource.prototype.c6 = function () {\r\n        var a = new Array(this.actualPrimaryKey.length);\r\n        for (var b = 0; b < a.length; b++) {\r\n            a[b] = 0;\r\n        }\r\n        return new DataSourcePropertiesComparer(this.actualPrimaryKey, a, this.cu, this);\r\n    };\r\n    VirtualDataSource.prototype.getStickyRowPriority = function (a) {\r\n        var b = this.getRowType(a);\r\n        switch (b) {\r\n            case 1: return 100 - this.getRowLevel(a);\r\n            case 2: return 99 - this.getRowLevel(a);\r\n            case 3:\r\n            case 5: return 2;\r\n            case 4: return 3;\r\n        }\r\n        return 1;\r\n    };\r\n    VirtualDataSource.prototype.unpinRow = function (a) {\r\n        _super.prototype.unpinRow.call(this, a);\r\n    };\r\n    VirtualDataSource.prototype.pinRow = function (a) {\r\n        _super.prototype.pinRow.call(this, a);\r\n    };\r\n    VirtualDataSource.prototype.isRowPinned = function (a) {\r\n        return _super.prototype.isRowPinned.call(this, a);\r\n    };\r\n    VirtualDataSource.prototype.getStickyRowsInRange = function (a, b) {\r\n        if ((this.groupDescriptions == null || this.groupDescriptions.k.count == 0) && (this.summaryDescriptions == null || this.summaryDescriptions.k.count == 0)) {\r\n            return null;\r\n        }\r\n        var c = this.c8(a);\r\n        var d = this.c8(b);\r\n        if (this.c9.t.count > 0) {\r\n            if (this.c9.t.count == 1) {\r\n                c = this.c9.t._inner[0];\r\n                d = this.c9.t._inner[0];\r\n            }\r\n            else {\r\n                c = this.c9.e(a);\r\n                if (c != null) {\r\n                    while (c.z != -1) {\r\n                        c = this.c9.t._inner[c.z];\r\n                    }\r\n                }\r\n                d = this.c9.e(b);\r\n                if (b >= this.actualCount - this.d0) {\r\n                    d = this.c9.d();\r\n                }\r\n            }\r\n        }\r\n        else if (this.d0 > 0) {\r\n            var e = new List$1(Number_$type, 0);\r\n            for (var f = this.actualCount - this.d0; f < this.actualCount; f++) {\r\n                e.add(f);\r\n            }\r\n            return e.toArray();\r\n        }\r\n        if (c == null || d == null) {\r\n            return null;\r\n        }\r\n        if (c.ae == this.ds && c.aa == this.du && c.af == this.dv && c.ad == this.dt && c.ah == this.dx && c.ag == this.dw && d.ae == this.dk && d.aa == this.dm && d.af == this.dn && d.ad == this.dl && d.ah == this.dq && d.ag == this.dp && this.d0 == this.dr) {\r\n            return this.cr;\r\n        }\r\n        this.ds = c.ae;\r\n        this.dk = d.ae;\r\n        this.du = c.aa;\r\n        this.dm = d.aa;\r\n        this.dv = c.af;\r\n        this.dn = d.af;\r\n        this.dt = c.ad;\r\n        this.dl = d.ad;\r\n        this.dq = d.ah;\r\n        this.dp = d.ag;\r\n        this.dx = c.ah;\r\n        this.dw = c.ag;\r\n        this.dr = this.d0;\r\n        var g = new List$1(Number_$type, 0);\r\n        for (var h = c.ae; h <= d.ae; h++) {\r\n            var i = this.c9.t._inner[h];\r\n            var j = i.c.length;\r\n            var k = i.v();\r\n            if (this.shouldEmitSectionHeaders && this.an) {\r\n                for (var l = 0; l < i.c.length; l++) {\r\n                    if (i.a[l] != null) {\r\n                        var m = i.af + i.b[l];\r\n                        g.add(m);\r\n                    }\r\n                    if (!i.c[l]) {\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            if (i.p) {\r\n                for (var n = 0; n < i.ah; n++) {\r\n                    g.add(i.af + n + k);\r\n                }\r\n                if (this.shouldEmitShiftedRows) {\r\n                    for (var o = 0; o < i.aa; o++) {\r\n                        g.add(i.af + o + j);\r\n                    }\r\n                }\r\n                if (this.summaryScope == 0 || this.summaryScope == 2) {\r\n                    if (this.includeSummaryRowsInSection && this.isSectionSummaryRowsAtBottom) {\r\n                        for (var p = i.ag - 1; p >= 0; p--) {\r\n                            if (this.shouldEmitSectionFooters) {\r\n                                g.add(i.ad - k - p);\r\n                            }\r\n                            else {\r\n                                g.add(i.ad - p);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n            if (this.shouldEmitSectionFooters && this.an) {\r\n                for (var q = i.c.length - 1; q >= 0; q--) {\r\n                    if (!i.c[q]) {\r\n                        break;\r\n                    }\r\n                    g.add(i.ad - q);\r\n                }\r\n            }\r\n        }\r\n        for (var r = this.actualCount - this.d0; r < this.actualCount; r++) {\r\n            g.add(r);\r\n        }\r\n        this.cr = g.toArray();\r\n        return this.cr;\r\n    };\r\n    VirtualDataSource.prototype.isExclusivelySticky = function (a) {\r\n        var b = this.getRowType(a);\r\n        return b == 1 || b == 2 || b == 4 || (this.isSectionSummaryRowsAtBottom && b == 5);\r\n    };\r\n    VirtualDataSource.prototype.getRowType = function (a) {\r\n        if (a < 0) {\r\n            return 0;\r\n        }\r\n        var b = this.getItemAtIndex(a);\r\n        var item_ = b;\r\n        if ((item_ != null && item_.$$isSpecialRow !== undefined)) {\r\n            var c = b.rowType;\r\n            if (this.isSectionHeaderNormalRow && c == 1) {\r\n                return 0;\r\n            }\r\n            return c;\r\n        }\r\n        return 0;\r\n    };\r\n    VirtualDataSource.prototype.getIsRowExpandedAtIndex = function (a) {\r\n        var b = this.c9.e(a);\r\n        if (b == null) {\r\n            b = this.c9.d();\r\n        }\r\n        for (var c = 0; c < b.a.length; c++) {\r\n            if (b.a[c] != null) {\r\n                if (a == b.af + b.b[c]) {\r\n                    return b.c[c];\r\n                }\r\n            }\r\n        }\r\n        return _super.prototype.getIsRowExpandedAtIndex.call(this, a);\r\n    };\r\n    VirtualDataSource.prototype.setIsRowExpandedAtIndex = function (a, b) {\r\n        var c = this.c9.e(a);\r\n        if (c == null) {\r\n            c = this.c9.d();\r\n        }\r\n        for (var d = 0; d < c.a.length; d++) {\r\n            if (c.a[d] != null) {\r\n                if (a == c.af + c.b[d]) {\r\n                    var e = false;\r\n                    var f = c.a[d];\r\n                    if (this.dg.containsKey(f) && this.dg.item(f) != b) {\r\n                        var g = this.dg.item(f);\r\n                        if (b == this.isSectionExpandedDefault) {\r\n                            this.dg.removeItem(f);\r\n                        }\r\n                        else {\r\n                            this.dg.item(f, b);\r\n                        }\r\n                        e = true;\r\n                        this.onRowExpansionChanged(a, g, b);\r\n                    }\r\n                    else if (b != this.isSectionExpandedDefault) {\r\n                        this.dg.addItem(f, b);\r\n                        e = true;\r\n                        this.onRowExpansionChanged(a, this.isSectionExpandedDefault, b);\r\n                    }\r\n                    if (e) {\r\n                        this.c9.v();\r\n                        this.ep();\r\n                        this.dd = true;\r\n                        if (this.actualCount != this.c9.u) {\r\n                            this.actualCount = this.c9.u + this.d0;\r\n                        }\r\n                        else {\r\n                            this.queueAutoRefresh();\r\n                        }\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    VirtualDataSource.prototype.getRowLevel = function (a) {\r\n        if (a < 0) {\r\n            return 0;\r\n        }\r\n        var b = this.getItemAtIndex(a);\r\n        var item_ = b;\r\n        if ((item_ != null && item_.$$isSpecialRow !== undefined)) {\r\n            return b.level;\r\n        }\r\n        if (this.isGroupingSupported) {\r\n            if (this.sectionHeaderDisplayMode == 1) {\r\n                return this.groupDescriptions.k.count;\r\n            }\r\n            else if (this.groupDescriptions.k.count > 0) {\r\n                return 1;\r\n            }\r\n        }\r\n        return 0;\r\n    };\r\n    VirtualDataSource.prototype.getRootSummaryRowCount = function () {\r\n        return this.d0;\r\n    };\r\n    VirtualDataSource.prototype.eb = function (a) {\r\n        var b = \"\";\r\n        for (var c = 0; c < a.e.length; c++) {\r\n            b += a.e[c] + \":\" + a.f[c];\r\n        }\r\n        return b;\r\n    };\r\n    VirtualDataSource.prototype.ec = function (a, b) {\r\n        if (this.sectionHeaderDisplayMode == 0) {\r\n            return this.eb(a);\r\n        }\r\n        var c = \"\";\r\n        for (var d = 0; d < a.e.length; d++) {\r\n            c += a.e[d] + \":\" + a.f[d] + \":\";\r\n        }\r\n        c += b;\r\n        return c;\r\n    };\r\n    VirtualDataSource.prototype.getRootSummaryResults = function () {\r\n        return this.cv;\r\n    };\r\n    VirtualDataSource.prototype.getSectionSummaryResults = function (a) {\r\n        if (this.c9.t.count > 0 && a >= 0 && a < this.c9.t.count) {\r\n            return this.c9.t._inner[a].i;\r\n        }\r\n        return null;\r\n    };\r\n    VirtualDataSource.prototype.clone = function () {\r\n        return null;\r\n    };\r\n    VirtualDataSource.prototype.cloneProperties = function (a) {\r\n        _super.prototype.cloneProperties.call(this, a);\r\n        var b = typeCast(VirtualDataSource.$, a);\r\n        if (b != null) {\r\n            b.pageSizeRequested = this.pageSizeRequested;\r\n            b.maxCachedPages = this.maxCachedPages;\r\n        }\r\n    };\r\n    Object.defineProperty(VirtualDataSource.prototype, \"concurrencyTag\", {\r\n        get: function () {\r\n            return this._concurrencyTag;\r\n        },\r\n        set: function (a) {\r\n            this._concurrencyTag = a;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    VirtualDataSource.prototype.get_isBatchingEnabled = function () {\r\n        return true;\r\n    };\r\n    VirtualDataSource.prototype.set_isBatchingEnabled = function (a) {\r\n        _super.prototype.set_isBatchingEnabled.call(this, a);\r\n    };\r\n    VirtualDataSource.prototype.updatePropertyAtKey = function (a, b, c, d) {\r\n        if (d === void 0) {\r\n            d = false;\r\n        }\r\n        var e = _super.prototype.updatePropertyAtKey.call(this, a, b, c);\r\n        if (this.concurrencyTag != null && this.ao()) {\r\n            var f = this.indexOfKey(a);\r\n            if (f > -1) {\r\n                var g = this.getItemAtIndex(f);\r\n                var h = this.actualDataProvider.getItemValue(g, this.concurrencyTag);\r\n                if (h != null) {\r\n                    var i = this.t.g(a);\r\n                    i.version = h;\r\n                }\r\n            }\r\n        }\r\n        return e;\r\n    };\r\n    VirtualDataSource.prototype.removeItemByKey = function (a) {\r\n        _super.prototype.removeItemByKey.call(this, a);\r\n        if (this.concurrencyTag != null && this.ao()) {\r\n            var b = this.indexOfKey(a);\r\n            if (b > -1) {\r\n                var c = this.getItemAtIndex(b);\r\n                var d = this.actualDataProvider.getItemValue(c, this.concurrencyTag);\r\n                if (d != null) {\r\n                    var e = this.t.g(a);\r\n                    e.version = d;\r\n                }\r\n            }\r\n        }\r\n    };\r\n    VirtualDataSource.prototype.cj = function (a, b) {\r\n        if (a == 5) {\r\n            var c = b;\r\n            var d_1 = c.a;\r\n            var e = new List$1(TransactionState.$, 0);\r\n            var _loop_1 = function (f) {\r\n                var e_2, _a, e_3, _b;\r\n                var g = d_1[f].transactionType;\r\n                var h = null;\r\n                var i = null;\r\n                if (g == TransactionType.Delete || g == 1) {\r\n                    var j = new Dictionary$2(String_$type, Base.$, 0);\r\n                    var k = d_1[f].id;\r\n                    for (var l = 0; l < this_1.actualPrimaryKey.length; l++) {\r\n                        j.addItem(this_1.actualPrimaryKey[l], k[l]);\r\n                    }\r\n                    h = j;\r\n                }\r\n                if (g == 0) {\r\n                    var m = new Dictionary$2(String_$type, Base.$, 0);\r\n                    var n = d_1[f].id[0];\r\n                    for (var o = 0; o < this_1.actualSchema.propertyNames.length; o++) {\r\n                        var p = this_1.actualSchema.propertyNames[o];\r\n                        m.addItem(p, this_1.actualDataProvider.getItemValue(n, p));\r\n                    }\r\n                    i = m;\r\n                }\r\n                else if (g == 1) {\r\n                    i = d_1[f].value;\r\n                }\r\n                if (h != null) {\r\n                    var q = {};\r\n                    var r = h;\r\n                    try {\r\n                        for (var _c = (e_2 = void 0, tslib_1.__values(fromEnum(r))), _d = _c.next(); !_d.done; _d = _c.next()) {\r\n                            var s = _d.value;\r\n                            q[s.key] = s.value;\r\n                        }\r\n                    }\r\n                    catch (e_2_1) {\r\n                        e_2 = { error: e_2_1 };\r\n                    }\r\n                    finally {\r\n                        try {\r\n                            if (_d && !_d.done && (_a = _c.return))\r\n                                _a.call(_c);\r\n                        }\r\n                        finally {\r\n                            if (e_2)\r\n                                throw e_2.error;\r\n                        }\r\n                    }\r\n                    h = q;\r\n                }\r\n                if (i != null) {\r\n                    var t = {};\r\n                    var u = i;\r\n                    try {\r\n                        for (var _e = (e_3 = void 0, tslib_1.__values(fromEnum(u))), _f = _e.next(); !_f.done; _f = _e.next()) {\r\n                            var v = _f.value;\r\n                            t[v.key] = v.value;\r\n                        }\r\n                    }\r\n                    catch (e_3_1) {\r\n                        e_3 = { error: e_3_1 };\r\n                    }\r\n                    finally {\r\n                        try {\r\n                            if (_f && !_f.done && (_b = _e.return))\r\n                                _b.call(_e);\r\n                        }\r\n                        finally {\r\n                            if (e_3)\r\n                                throw e_3.error;\r\n                        }\r\n                    }\r\n                    i = t;\r\n                }\r\n                e.add(((function () {\r\n                    var $ret = new TransactionState(h, g, i);\r\n                    $ret.version = d_1[f].version;\r\n                    return $ret;\r\n                })()));\r\n            };\r\n            var this_1 = this;\r\n            for (var f = 0; f < d_1.length; f++) {\r\n                _loop_1(f);\r\n            }\r\n            var w = e.toArray();\r\n            if (this.batchStarted != null) {\r\n                this.batchStarted(this, new DataSourceBatchStartedEventArgs(w));\r\n            }\r\n            this.actualDataProvider.createBatchRequest(w);\r\n        }\r\n    };\r\n    VirtualDataSource.prototype.ej = function (a, b, c) {\r\n        if (b) {\r\n            this.queueAutoRefresh();\r\n        }\r\n        if (this.batchCompleted != null) {\r\n            this.batchCompleted(this, new DataSourceBatchCompletedEventArgs(a, c));\r\n        }\r\n    };\r\n    VirtualDataSource.$t = markType(VirtualDataSource, 'VirtualDataSource', BaseDataSource.$, [IPageCandidatesSink_$type]);\r\n    return VirtualDataSource;\r\n}(BaseDataSource));\r\nexport { VirtualDataSource };\r\n//# sourceMappingURL=VirtualDataSource.js.map\r\n"]},"metadata":{},"sourceType":"module"}