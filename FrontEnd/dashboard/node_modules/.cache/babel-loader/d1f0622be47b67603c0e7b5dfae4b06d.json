{"ast":null,"code":"/*\nTHIS INFRAGISTICS ULTIMATE SOFTWARE LICENSE  AGREEMENT (\"AGREEMENT\") LOCATED HERE:\nhttps://www.infragistics.com/legal/license/igultimate-la\nhttps://www.infragistics.com/legal/license/igultimate-eula\nGOVERNS THE LICENSING, INSTALLATION AND USE OF INFRAGISTICS SOFTWARE. BY DOWNLOADING AND/OR INSTALLING AND USING INFRAGISTICS SOFTWARE:  you are indicating that you have read and understand this Agreement, and agree to be legally bound by it on behalf of the yourself and your company.\n*/\nimport * as tslib_1 from \"tslib\";\nimport { Base, runOn, String_$type, Delegate_$type, markType } from \"./type\";\nimport { Dictionary$2 } from \"./Dictionary$2\";\nimport { TileWorkSettings } from \"./TileWorkSettings\";\nimport { LinkedList$1 } from \"./LinkedList$1\";\nimport { HeatTileGeneratorWorker } from \"./HeatTileGeneratorWorker\";\nimport { List$1 } from \"./List$1\";\nimport { LinkedListNode$1 } from \"./LinkedListNode$1\";\nimport { HeatTileImageCreatedEventArgs } from \"./HeatTileImageCreatedEventArgs\";\nimport { ITileWorkCompletedSink_$type } from \"./ITileWorkCompletedSink\";\n/**\n * @hidden\n */\n\nvar HeatTileGeneratorWorkerManager =\n/** @class */\n\n/*@__PURE__*/\nfunction (_super) {\n  tslib_1.__extends(HeatTileGeneratorWorkerManager, _super);\n\n  function HeatTileGeneratorWorkerManager() {\n    var _this = _super.call(this) || this;\n\n    _this.b = true;\n    _this.o = null;\n    _this.k = null;\n    _this._supportsTransferable = false;\n    _this.d = false;\n    _this._worker = null;\n    _this.a = false;\n    _this.j = 0;\n    _this.g = new Dictionary$2(String_$type, TileWorkSettings.$, 0);\n    _this.h = new Dictionary$2(String_$type, Delegate_$type, 0);\n    _this.i = new LinkedList$1(HeatTileGeneratorWorker.$);\n    _this.f = new Dictionary$2(String_$type, List$1.$.specialize(LinkedListNode$1.$.specialize(HeatTileGeneratorWorker.$)), 0);\n    return _this;\n  }\n\n  Object.defineProperty(HeatTileGeneratorWorkerManager.prototype, \"e\", {\n    get: function () {\n      return this.b;\n    },\n    set: function (a) {\n      this.b = a;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(HeatTileGeneratorWorkerManager.prototype, \"p\", {\n    get: function () {\n      return this.o;\n    },\n    set: function (a) {\n      this.o = a;\n    },\n    enumerable: true,\n    configurable: true\n  });\n  Object.defineProperty(HeatTileGeneratorWorkerManager.prototype, \"n\", {\n    get: function () {\n      return this.k;\n    },\n    set: function (a) {\n      this.k = a;\n    },\n    enumerable: true,\n    configurable: true\n  });\n\n  HeatTileGeneratorWorkerManager.prototype.u = function () {\n    if (!this.a) {\n      this.a = true;\n\n      if (window.Worker) {\n        this.d = true;\n      }\n\n      if (this.d && this.e) {\n        this.v();\n        var test = new ArrayBuffer(1);\n\n        this._worker.postMessage(test, [test]);\n\n        if (test.byteLength == 0) {\n          this._supportsTransferable = true;\n        }\n\n        ;\n      }\n\n      if (!this._supportsTransferable) {\n        this.b = false;\n      }\n    }\n  };\n\n  HeatTileGeneratorWorkerManager.prototype.v = function () {\n    if (this.p == null && this.n == null) {\n      throw new Error('HeatTileGenerator wants to use web workers, but webWorkerScriptPath and webWorkerInstance were not specified. Either specify the path, an instance, or set allowWebWorkers to false');\n    }\n\n    if (this.n != null) {\n      this._worker = this.n;\n    } else {\n      var path_ = this.p;\n      this._worker = new Worker(path_);\n    }\n\n    this._worker.postMessage = this._worker.webkitPostMessage || this._worker.postMessage;\n    var onMessage_ = runOn(this, this.z);\n    this._worker.onmessage = onMessage_;\n  };\n\n  HeatTileGeneratorWorkerManager.prototype.z = function (args_) {\n    var data_ = args_.data;\n    var a = new HeatTileImageCreatedEventArgs();\n    a.imageData = data_.imageData == null ? null : new Uint8ClampedArray(data_.imageData);\n    a.z = data_.z;\n    a.x = data_.x;\n    a.y = data_.y;\n    a.url = data_.url;\n    a.globalMinimumValue = data_.globalMinimumValue;\n    a.globalMaximumValue = data_.globalMaximumValue;\n    a.globalMaximumValueLongitude = data_.globalMaximumValueLongitude;\n    a.globalMaximumValueLatitude = data_.globalMaximumValueLatitude;\n    a.globalMinimumValueLongitude = data_.globalMinimumValueLongitude;\n    a.globalMinimumValueLatitude = data_.globalMinimumValueLatitude;\n    var b = data_.messageId.toString();\n\n    if (!this.g.containsKey(b)) {\n      return;\n    }\n\n    var c = this.g.item(b);\n    var d = this.h.item(b);\n    this.g.removeItem(b);\n    this.h.removeItem(b);\n    a.image = c.image;\n    d(this, a);\n  };\n\n  HeatTileGeneratorWorkerManager.prototype.x = function () {\n    this.u();\n\n    if (this.e && this._worker == null) {\n      this.v();\n    }\n\n    if (!this.e && this._worker != null) {\n      this._worker.terminate();\n\n      this._worker.onmessage = null;\n      this._worker = null;\n    }\n  };\n\n  HeatTileGeneratorWorkerManager.prototype.toDoubleArray = function (arr_) {\n    return new Float64Array(arr_).buffer;\n  };\n\n  HeatTileGeneratorWorkerManager.prototype.r = function (a, b, c) {\n    this.j++;\n\n    if (this.j >= 0x7FFFFFFF) {\n      this.j = 1;\n    }\n\n    this.g.addItem(this.j.toString(), a);\n    this.h.addItem(this.j.toString(), b);\n    var messageId_ = this.j;\n    var innerSettings_ = a.flatten();\n    innerSettings_.messageId = messageId_;\n    innerSettings_.transferableSupported = this._supportsTransferable;\n\n    if (a.isNewData) {\n      innerSettings_.latitudes = this.toDoubleArray(innerSettings_.latitudes);\n      innerSettings_.longitudes = this.toDoubleArray(innerSettings_.longitudes);\n      innerSettings_.values = this.toDoubleArray(innerSettings_.values);\n    } else {\n      innerSettings_.latitudes = null;\n      innerSettings_.longitudes = null;\n      innerSettings_.values = null;\n    }\n\n    if (this._supportsTransferable && a.isNewData) {\n      this._worker.postMessage(innerSettings_, [innerSettings_.latitudes, innerSettings_.longitudes, innerSettings_.values]);\n    } else {\n      this._worker.postMessage(innerSettings_);\n    }\n  };\n\n  HeatTileGeneratorWorkerManager.prototype.t = function (z_, x_, y_) {\n    var cancelMsg_ = {\n      cancelTile: true,\n      z: z_,\n      x: x_,\n      y: y_\n    };\n\n    this._worker.postMessage(cancelMsg_);\n  };\n\n  HeatTileGeneratorWorkerManager.prototype.y = function (a, b, c) {\n    this.x();\n\n    if (this.e) {\n      this.r(a, b, c);\n    } else {\n      this.q(a, b, c);\n    }\n  };\n\n  HeatTileGeneratorWorkerManager.prototype.aa = function () {\n    var _this = this;\n\n    if (this.i.c != null) {\n      var a = this.i.c;\n      this.i.h(a);\n      var b = a.c.g;\n\n      if (this.f.containsKey(b.z + \"_\" + b.x + \"_\" + b.y)) {\n        var c = this.f.item(b.z + \"_\" + b.x + \"_\" + b.y);\n        c.remove(a);\n\n        if (c.count == 0) {\n          this.f.removeItem(b.z + \"_\" + b.x + \"_\" + b.y);\n        }\n      }\n\n      a.c.doWork();\n    }\n\n    if (this.i.c != null) {\n      window.setTimeout(function () {\n        return _this.aa();\n      }, 16);\n    }\n  };\n\n  HeatTileGeneratorWorkerManager.prototype.q = function (a, b, c) {\n    var _this = this;\n\n    {\n      var d = new HeatTileGeneratorWorker(a);\n      d.completedSink = new TileWorkCompletedSink(this, b);\n      this.i.f(d);\n      var e = void 0;\n      var f = d.g.z + \"_\" + d.g.x + \"_\" + d.g.y;\n\n      if (this.f.containsKey(f)) {\n        e = this.f.item(f);\n      } else {\n        e = new List$1(LinkedListNode$1.$.specialize(HeatTileGeneratorWorker.$), 0);\n        this.f.addItem(f, e);\n      }\n\n      e.add(this.i.d);\n      window.setTimeout(function () {\n        return _this.aa();\n      }, 16);\n    }\n  };\n\n  HeatTileGeneratorWorkerManager.prototype.w = function () {\n    if (this._worker != null) {\n      this._worker.terminate();\n\n      this._worker = null;\n    }\n\n    this.g.clear();\n    this.h.clear();\n  };\n\n  HeatTileGeneratorWorkerManager.prototype.s = function (a, b, c) {\n    this.x();\n\n    if (this.e) {\n      this.t(a, b, c);\n    } else {\n      if (this.f.containsKey(a + \"_\" + b + \"_\" + c)) {\n        var d = this.f.item(a + \"_\" + b + \"_\" + c);\n\n        for (var e = d.count - 1; e >= 0; e--) {\n          var f = d._inner[e];\n\n          if (f.c.g.testRun) {\n            continue;\n          }\n\n          d.removeAt(e);\n          var g = f.c;\n          this.i.h(f);\n          g.completedSink = null;\n        }\n      }\n    }\n  };\n\n  HeatTileGeneratorWorkerManager.$t = markType(HeatTileGeneratorWorkerManager, 'HeatTileGeneratorWorkerManager');\n  return HeatTileGeneratorWorkerManager;\n}(Base);\n\nexport { HeatTileGeneratorWorkerManager };\n/**\n * @hidden\n */\n\nvar TileWorkCompletedSink =\n/** @class */\n\n/*@__PURE__*/\nfunction (_super) {\n  tslib_1.__extends(TileWorkCompletedSink, _super);\n\n  function TileWorkCompletedSink(a, b) {\n    var _this = _super.call(this) || this;\n\n    _this.a = null;\n    _this.b = null;\n    _this.a = a;\n    _this.b = b;\n    return _this;\n  }\n\n  TileWorkCompletedSink.prototype.onCompleted = function (a) {\n    this.b(this.a, a);\n  };\n\n  TileWorkCompletedSink.$t = markType(TileWorkCompletedSink, 'TileWorkCompletedSink', Base.$, [ITileWorkCompletedSink_$type]);\n  return TileWorkCompletedSink;\n}(Base);\n\nexport { TileWorkCompletedSink };","map":{"version":3,"sources":["../../../../src/igniteui-core/lib/HeatTileGeneratorWorkerManager_combined.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["/*\nTHIS INFRAGISTICS ULTIMATE SOFTWARE LICENSE  AGREEMENT (\"AGREEMENT\") LOCATED HERE:\nhttps://www.infragistics.com/legal/license/igultimate-la\nhttps://www.infragistics.com/legal/license/igultimate-eula\nGOVERNS THE LICENSING, INSTALLATION AND USE OF INFRAGISTICS SOFTWARE. BY DOWNLOADING AND/OR INSTALLING AND USING INFRAGISTICS SOFTWARE:  you are indicating that you have read and understand this Agreement, and agree to be legally bound by it on behalf of the yourself and your company.\n*/\nimport * as tslib_1 from \"tslib\";\nimport { Base, runOn, String_$type, Delegate_$type, markType } from \"./type\";\nimport { Dictionary$2 } from \"./Dictionary$2\";\nimport { TileWorkSettings } from \"./TileWorkSettings\";\nimport { LinkedList$1 } from \"./LinkedList$1\";\nimport { HeatTileGeneratorWorker } from \"./HeatTileGeneratorWorker\";\nimport { List$1 } from \"./List$1\";\nimport { LinkedListNode$1 } from \"./LinkedListNode$1\";\nimport { HeatTileImageCreatedEventArgs } from \"./HeatTileImageCreatedEventArgs\";\nimport { ITileWorkCompletedSink_$type } from \"./ITileWorkCompletedSink\";\n/**\n * @hidden\n */\nvar HeatTileGeneratorWorkerManager = /** @class */ /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(HeatTileGeneratorWorkerManager, _super);\n    function HeatTileGeneratorWorkerManager() {\n        var _this = _super.call(this) || this;\n        _this.b = true;\n        _this.o = null;\n        _this.k = null;\n        _this._supportsTransferable = false;\n        _this.d = false;\n        _this._worker = null;\n        _this.a = false;\n        _this.j = 0;\n        _this.g = new Dictionary$2(String_$type, TileWorkSettings.$, 0);\n        _this.h = new Dictionary$2(String_$type, Delegate_$type, 0);\n        _this.i = new LinkedList$1(HeatTileGeneratorWorker.$);\n        _this.f = new Dictionary$2(String_$type, List$1.$.specialize(LinkedListNode$1.$.specialize(HeatTileGeneratorWorker.$)), 0);\n        return _this;\n    }\n    Object.defineProperty(HeatTileGeneratorWorkerManager.prototype, \"e\", {\n        get: function () {\n            return this.b;\n        },\n        set: function (a) {\n            this.b = a;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(HeatTileGeneratorWorkerManager.prototype, \"p\", {\n        get: function () {\n            return this.o;\n        },\n        set: function (a) {\n            this.o = a;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(HeatTileGeneratorWorkerManager.prototype, \"n\", {\n        get: function () {\n            return this.k;\n        },\n        set: function (a) {\n            this.k = a;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    HeatTileGeneratorWorkerManager.prototype.u = function () {\n        if (!this.a) {\n            this.a = true;\n            if ((window.Worker)) {\n                this.d = true;\n            }\n            if (this.d && this.e) {\n                this.v();\n                var test = new ArrayBuffer(1);\n                this._worker.postMessage(test, [test]);\n                if (test.byteLength == 0) {\n                    this._supportsTransferable = true;\n                }\n                ;\n            }\n            if (!this._supportsTransferable) {\n                this.b = false;\n            }\n        }\n    };\n    HeatTileGeneratorWorkerManager.prototype.v = function () {\n        if (this.p == null && this.n == null) {\n            throw new Error('HeatTileGenerator wants to use web workers, but webWorkerScriptPath and webWorkerInstance were not specified. Either specify the path, an instance, or set allowWebWorkers to false');\n        }\n        if (this.n != null) {\n            this._worker = this.n;\n        }\n        else {\n            var path_ = this.p;\n            this._worker = new Worker(path_);\n        }\n        this._worker.postMessage = this._worker.webkitPostMessage || this._worker.postMessage;\n        var onMessage_ = runOn(this, this.z);\n        this._worker.onmessage = onMessage_;\n    };\n    HeatTileGeneratorWorkerManager.prototype.z = function (args_) {\n        var data_ = args_.data;\n        var a = new HeatTileImageCreatedEventArgs();\n        a.imageData = (data_.imageData == null ? null : new Uint8ClampedArray(data_.imageData));\n        a.z = (data_.z);\n        a.x = (data_.x);\n        a.y = (data_.y);\n        a.url = (data_.url);\n        a.globalMinimumValue = (data_.globalMinimumValue);\n        a.globalMaximumValue = (data_.globalMaximumValue);\n        a.globalMaximumValueLongitude = (data_.globalMaximumValueLongitude);\n        a.globalMaximumValueLatitude = (data_.globalMaximumValueLatitude);\n        a.globalMinimumValueLongitude = (data_.globalMinimumValueLongitude);\n        a.globalMinimumValueLatitude = (data_.globalMinimumValueLatitude);\n        var b = (data_.messageId.toString());\n        if (!this.g.containsKey(b)) {\n            return;\n        }\n        var c = this.g.item(b);\n        var d = this.h.item(b);\n        this.g.removeItem(b);\n        this.h.removeItem(b);\n        a.image = c.image;\n        d(this, a);\n    };\n    HeatTileGeneratorWorkerManager.prototype.x = function () {\n        this.u();\n        if (this.e && this._worker == null) {\n            this.v();\n        }\n        if (!this.e && this._worker != null) {\n            this._worker.terminate();\n            this._worker.onmessage = null;\n            this._worker = null;\n        }\n    };\n    HeatTileGeneratorWorkerManager.prototype.toDoubleArray = function (arr_) {\n        return new Float64Array(arr_).buffer;\n    };\n    HeatTileGeneratorWorkerManager.prototype.r = function (a, b, c) {\n        this.j++;\n        if (this.j >= 0x7FFFFFFF) {\n            this.j = 1;\n        }\n        this.g.addItem(this.j.toString(), a);\n        this.h.addItem(this.j.toString(), b);\n        var messageId_ = this.j;\n        var innerSettings_ = a.flatten();\n        innerSettings_.messageId = messageId_;\n        innerSettings_.transferableSupported = this._supportsTransferable;\n        if (a.isNewData) {\n            innerSettings_.latitudes = this.toDoubleArray(innerSettings_.latitudes);\n            innerSettings_.longitudes = this.toDoubleArray(innerSettings_.longitudes);\n            innerSettings_.values = this.toDoubleArray(innerSettings_.values);\n        }\n        else {\n            innerSettings_.latitudes = null;\n            innerSettings_.longitudes = null;\n            innerSettings_.values = null;\n        }\n        if (this._supportsTransferable && a.isNewData) {\n            this._worker.postMessage(innerSettings_, [innerSettings_.latitudes,\n                innerSettings_.longitudes,\n                innerSettings_.values]);\n        }\n        else {\n            this._worker.postMessage(innerSettings_);\n        }\n    };\n    HeatTileGeneratorWorkerManager.prototype.t = function (z_, x_, y_) {\n        var cancelMsg_ = {\n            cancelTile: true,\n            z: z_,\n            x: x_,\n            y: y_\n        };\n        this._worker.postMessage(cancelMsg_);\n    };\n    HeatTileGeneratorWorkerManager.prototype.y = function (a, b, c) {\n        this.x();\n        if (this.e) {\n            this.r(a, b, c);\n        }\n        else {\n            this.q(a, b, c);\n        }\n    };\n    HeatTileGeneratorWorkerManager.prototype.aa = function () {\n        var _this = this;\n        if (this.i.c != null) {\n            var a = this.i.c;\n            this.i.h(a);\n            var b = a.c.g;\n            if (this.f.containsKey(b.z + \"_\" + b.x + \"_\" + b.y)) {\n                var c = this.f.item(b.z + \"_\" + b.x + \"_\" + b.y);\n                c.remove(a);\n                if (c.count == 0) {\n                    this.f.removeItem(b.z + \"_\" + b.x + \"_\" + b.y);\n                }\n            }\n            a.c.doWork();\n        }\n        if (this.i.c != null) {\n            window.setTimeout(function () { return _this.aa(); }, 16);\n        }\n    };\n    HeatTileGeneratorWorkerManager.prototype.q = function (a, b, c) {\n        var _this = this;\n        {\n            var d = new HeatTileGeneratorWorker(a);\n            d.completedSink = new TileWorkCompletedSink(this, b);\n            this.i.f(d);\n            var e = void 0;\n            var f = d.g.z + \"_\" + d.g.x + \"_\" + d.g.y;\n            if (this.f.containsKey(f)) {\n                e = this.f.item(f);\n            }\n            else {\n                e = new List$1(LinkedListNode$1.$.specialize(HeatTileGeneratorWorker.$), 0);\n                this.f.addItem(f, e);\n            }\n            e.add(this.i.d);\n            window.setTimeout(function () { return _this.aa(); }, 16);\n        }\n    };\n    HeatTileGeneratorWorkerManager.prototype.w = function () {\n        if (this._worker != null) {\n            this._worker.terminate();\n            this._worker = null;\n        }\n        this.g.clear();\n        this.h.clear();\n    };\n    HeatTileGeneratorWorkerManager.prototype.s = function (a, b, c) {\n        this.x();\n        if (this.e) {\n            this.t(a, b, c);\n        }\n        else {\n            if (this.f.containsKey(a + \"_\" + b + \"_\" + c)) {\n                var d = this.f.item(a + \"_\" + b + \"_\" + c);\n                for (var e = d.count - 1; e >= 0; e--) {\n                    var f = d._inner[e];\n                    if (f.c.g.testRun) {\n                        continue;\n                    }\n                    d.removeAt(e);\n                    var g = f.c;\n                    this.i.h(f);\n                    g.completedSink = null;\n                }\n            }\n        }\n    };\n    HeatTileGeneratorWorkerManager.$t = markType(HeatTileGeneratorWorkerManager, 'HeatTileGeneratorWorkerManager');\n    return HeatTileGeneratorWorkerManager;\n}(Base));\nexport { HeatTileGeneratorWorkerManager };\n/**\n * @hidden\n */\nvar TileWorkCompletedSink = /** @class */ /*@__PURE__*/ (function (_super) {\n    tslib_1.__extends(TileWorkCompletedSink, _super);\n    function TileWorkCompletedSink(a, b) {\n        var _this = _super.call(this) || this;\n        _this.a = null;\n        _this.b = null;\n        _this.a = a;\n        _this.b = b;\n        return _this;\n    }\n    TileWorkCompletedSink.prototype.onCompleted = function (a) {\n        this.b(this.a, a);\n    };\n    TileWorkCompletedSink.$t = markType(TileWorkCompletedSink, 'TileWorkCompletedSink', Base.$, [ITileWorkCompletedSink_$type]);\n    return TileWorkCompletedSink;\n}(Base));\nexport { TileWorkCompletedSink };\n//# sourceMappingURL=HeatTileGeneratorWorkerManager_combined.js.map\n"]},"metadata":{},"sourceType":"module"}